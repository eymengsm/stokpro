<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StokPro - Elektronik & Telefon MaÄŸazasÄ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#2563eb',
                        secondary: '#64748b'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen font-sans text-gray-900 dark:text-white transition-colors duration-300">
    <header class="bg-white dark:bg-gray-800 shadow-sm border-b dark:border-gray-700 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-xl font-bold text-gray-900 dark:text-white">ğŸ“± StokPro</h1>
                        <p class="text-xs text-gray-500 dark:text-gray-400">Elektronik & Telefon</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Quick Stats -->
                    <div class="hidden md:flex items-center space-x-4 text-sm">
                        <div class="text-center">
                            <div class="font-medium text-gray-900 dark:text-white" id="quickTotalProducts">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">ÃœrÃ¼n</div>
                        </div>
                        <div class="text-center">
                            <div class="font-medium text-green-600" id="quickTodaySales">â‚º0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">BugÃ¼n</div>
                        </div>
                        <div class="text-center">
                            <div class="font-medium text-yellow-600" id="quickLowStock">0</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">DÃ¼ÅŸÃ¼k Stok</div>
                        </div>
                    </div>
                    
                    <button id="themeToggle" class="p-2 rounded-lg bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors">
                        <span id="themeIcon">ğŸŒ™</span>
                    </button>
                    <div class="text-sm text-gray-600 dark:text-gray-300 hidden md:block cursor-pointer" id="companyInfo">
                        <div class="font-medium" id="companyName">EYMEN MOBILE ELEKTRONÄ°K</div>
                        <div class="text-xs" id="companyPhone">+90 555 123 45 67</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <nav class="bg-white dark:bg-gray-800 border-b dark:border-gray-700 sticky top-16 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex space-x-8 overflow-x-auto">
                <button class="nav-btn py-4 px-2 border-b-2 border-primary text-primary font-medium whitespace-nowrap" data-tab="dashboard">
                    ğŸ“Š Dashboard
                </button>
                <button class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 font-medium whitespace-nowrap" data-tab="inventory">
                    ğŸ“¦ Stok YÃ¶netimi
                </button>
                <button class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 font-medium whitespace-nowrap" data-tab="sales">
                    ğŸ’° SatÄ±ÅŸlar
                </button>
                <button class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 font-medium whitespace-nowrap" data-tab="customers">
                    ğŸ‘¥ MÃ¼ÅŸteriler
                </button>
                <button class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 font-medium whitespace-nowrap" data-tab="reports">
                    ğŸ“ˆ Raporlar
                </button>
                <button class="nav-btn py-4 px-2 border-b-2 border-transparent text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 font-medium whitespace-nowrap" data-tab="settings">
                    âš™ï¸ Ayarlar
                </button>
            </div>
        </div>
    </nav>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <!-- KPI Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 rounded-lg shadow p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-100">Toplam ÃœrÃ¼n</p>
                            <p class="text-3xl font-bold" id="totalProducts">0</p>
                            <p class="text-sm text-blue-100 mt-1">Stok miktarÄ±</p>
                        </div>
                        <div class="text-4xl opacity-80">ğŸ“±</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-green-500 to-green-600 rounded-lg shadow p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-100">BugÃ¼nkÃ¼ SatÄ±ÅŸ</p>
                            <p class="text-3xl font-bold" id="todaySales">â‚º0</p>
                            <p class="text-sm text-green-100 mt-1">GÃ¼nlÃ¼k ciro</p>
                        </div>
                        <div class="text-4xl opacity-80">ğŸ’°</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-yellow-500 to-yellow-600 rounded-lg shadow p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-yellow-100">DÃ¼ÅŸÃ¼k Stok</p>
                            <p class="text-3xl font-bold" id="lowStock">0</p>
                            <p class="text-sm text-yellow-100 mt-1">Acil mÃ¼dahale</p>
                        </div>
                        <div class="text-4xl opacity-80">âš ï¸</div>
                    </div>
                </div>
                
                <div class="bg-gradient-to-r from-purple-500 to-purple-600 rounded-lg shadow p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-100">Toplam Kar</p>
                            <p class="text-3xl font-bold" id="totalProfit">â‚º0</p>
                            <p class="text-sm text-purple-100 mt-1">Net kar</p>
                        </div>
                        <div class="text-4xl opacity-80">ğŸ“ˆ</div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
                <div class="lg:col-span-2 bg-white dark:bg-gray-800 rounded-lg shadow p-6 border dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Son SatÄ±ÅŸlar</h3>
                    <div id="recentSales" class="space-y-3 max-h-64 overflow-y-auto">
                    </div>
                </div>
                
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 border dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">HÄ±zlÄ± Ä°ÅŸlemler</h3>
                    <div class="space-y-3">
                        <button id="quickSaleBtn" class="w-full bg-green-600 hover:bg-green-700 text-white p-3 rounded-lg font-medium transition-colors">
                            ğŸ’° HÄ±zlÄ± SatÄ±ÅŸ
                        </button>
                        <button id="quickAddProductBtn" class="w-full bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-lg font-medium transition-colors">
                            ğŸ“¦ ÃœrÃ¼n Ekle
                        </button>
                        <button id="quickAddCustomerBtn" class="w-full bg-purple-600 hover:bg-purple-700 text-white p-3 rounded-lg font-medium transition-colors">
                            ğŸ‘¤ MÃ¼ÅŸteri Ekle
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Inventory Tab -->
        <div id="inventory" class="tab-content hidden">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">Stok YÃ¶netimi</h2>
                <button id="addProductBtn" class="bg-primary hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                    â• Yeni ÃœrÃ¼n Ekle
                </button>
            </div>

            <!-- Filters -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow border dark:border-gray-700 mb-6">
                <div class="p-4 border-b dark:border-gray-700">
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <input type="text" id="searchProduct" placeholder="ÃœrÃ¼n, marka, model ara..." class="px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        <select id="categoryFilter" class="px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">TÃ¼m Kategoriler</option>
                            <option value="Telefon">Telefon</option>
                            <option value="Tablet">Tablet</option>
                            <option value="Aksesuar">Aksesuar</option>
                            <option value="KulaklÄ±k">KulaklÄ±k</option>
                            <option value="Laptop">Laptop</option>
                            <option value="Saat">AkÄ±llÄ± Saat</option>
                            <option value="Kamera">Kamera</option>
                        </select>
                        <select id="brandFilter" class="px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">TÃ¼m Markalar</option>
                            <option value="Apple">Apple</option>
                            <option value="Samsung">Samsung</option>
                            <option value="Xiaomi">Xiaomi</option>
                            <option value="Huawei">Huawei</option>
                            <option value="Oppo">Oppo</option>
                            <option value="Vivo">Vivo</option>
                            <option value="Realme">Realme</option>
                            <option value="OnePlus">OnePlus</option>
                            <option value="Sony">Sony</option>
                            <option value="LG">LG</option>
                        </select>
                        <select id="conditionFilter" class="px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">TÃ¼m Durumlar</option>
                            <option value="SÄ±fÄ±r">SÄ±fÄ±r</option>
                            <option value="SÄ±fÄ±r AyarÄ±nda">SÄ±fÄ±r AyarÄ±nda</option>
                            <option value="Az KullanÄ±lmÄ±ÅŸ">Az KullanÄ±lmÄ±ÅŸ</option>
                            <option value="Ä°yi Durumda">Ä°yi Durumda</option>
                            <option value="Orta Durumda">Orta Durumda</option>
                            <option value="HasarlÄ±">HasarlÄ±</option>
                        </select>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                        <select id="stockFilter" class="px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">TÃ¼m Stok DurumlarÄ±</option>
                            <option value="out">TÃ¼kenen (0)</option>
                            <option value="low">DÃ¼ÅŸÃ¼k (1-4)</option>
                            <option value="normal">Normal (5+)</option>
                        </select>
                        <select id="colorFilter" class="px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">TÃ¼m Renkler</option>
                            <option value="Siyah">Siyah</option>
                            <option value="Beyaz">Beyaz</option>
                            <option value="Gri">Gri</option>
                            <option value="Space Gray">Space Gray</option>
                            <option value="Gece YarÄ±sÄ±">Gece YarÄ±sÄ±</option>
                            <option value="Mavi">Mavi</option>
                            <option value="AÃ§Ä±k Mavi">AÃ§Ä±k Mavi</option>
                            <option value="Lacivert">Lacivert</option>
                            <option value="YeÅŸil">YeÅŸil</option>
                            <option value="AÃ§Ä±k YeÅŸil">AÃ§Ä±k YeÅŸil</option>
                            <option value="Koyu YeÅŸil">Koyu YeÅŸil</option>
                            <option value="Mor">Mor</option>
                            <option value="AÃ§Ä±k Mor">AÃ§Ä±k Mor</option>
                            <option value="Koyu Mor">Koyu Mor</option>
                            <option value="KÄ±rmÄ±zÄ±">KÄ±rmÄ±zÄ±</option>
                            <option value="Pembe">Pembe</option>
                            <option value="AÃ§Ä±k Pembe">AÃ§Ä±k Pembe</option>
                            <option value="AltÄ±n">AltÄ±n</option>
                            <option value="Rose Gold">Rose Gold</option>
                            <option value="GÃ¼mÃ¼ÅŸ">GÃ¼mÃ¼ÅŸ</option>
                            <option value="Bronz">Bronz</option>
                            <option value="Titanyum">Titanyum</option>
                            <option value="SarÄ±">SarÄ±</option>
                            <option value="Turuncu">Turuncu</option>
                            <option value="Kahverengi">Kahverengi</option>
                            <option value="Coral">Coral</option>
                            <option value="Mint">Mint</option>
                            <option value="Lavanta">Lavanta</option>
                        </select>
                        <button id="clearFilters" class="px-3 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors">
                            ğŸ—‘ï¸ Filtreleri Temizle
                        </button>
                    </div>
                </div>
                
                <!-- Product Table -->
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">ÃœrÃ¼n</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ã–zellikler</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Durum</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Stok</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Seri No</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">AlÄ±ÅŸ FiyatÄ±</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">SatÄ±ÅŸ FiyatÄ±</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Kar</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody id="productTable" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Sales Tab -->
        <div id="sales" class="tab-content hidden">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">ğŸ’° SatÄ±ÅŸ Ä°ÅŸlemleri</h2>
                <button id="newSaleBtn" class="bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-6 py-3 rounded-lg font-medium transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105">
                    ğŸ’° Yeni SatÄ±ÅŸ Yap
                </button>
            </div>

            <!-- Sales Statistics -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                <div class="bg-gradient-to-br from-green-500 to-green-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-medium text-green-100 mb-1">BugÃ¼n</h3>
                            <p class="text-3xl font-bold" id="todayTotal">â‚º0</p>
                            <p class="text-sm text-green-100 mt-1" id="todayCount">0 satÄ±ÅŸ</p>
                        </div>
                        <div class="text-4xl opacity-80">ğŸ“ˆ</div>
                    </div>
                </div>
                <div class="bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-medium text-blue-100 mb-1">Bu Hafta</h3>
                            <p class="text-3xl font-bold" id="weekTotal">â‚º0</p>
                            <p class="text-sm text-blue-100 mt-1" id="weekCount">0 satÄ±ÅŸ</p>
                        </div>
                        <div class="text-4xl opacity-80">ğŸ“Š</div>
                    </div>
                </div>
                <div class="bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-medium text-purple-100 mb-1">Bu Ay</h3>
                            <p class="text-3xl font-bold" id="monthTotal">â‚º0</p>
                            <p class="text-sm text-purple-100 mt-1" id="monthCount">0 satÄ±ÅŸ</p>
                        </div>
                        <div class="text-4xl opacity-80">ğŸ“…</div>
                    </div>
                </div>
                <div class="bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl shadow-lg p-6 text-white">
                    <div class="flex items-center justify-between">
                        <div>
                            <h3 class="text-lg font-medium text-orange-100 mb-1">Toplam Kar</h3>
                            <p class="text-3xl font-bold" id="totalSalesProfit">â‚º0</p>
                            <p class="text-sm text-orange-100 mt-1">Net kar</p>
                        </div>
                        <div class="text-4xl opacity-80">ğŸ’</div>
                    </div>
                </div>
            </div>

            <!-- Sales Filters and Search -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow border dark:border-gray-700 mb-6">
                <div class="p-6 border-b dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">ğŸ” SatÄ±ÅŸ Filtreleri</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">BaÅŸlangÄ±Ã§ Tarihi</label>
                            <input type="date" id="salesDateFrom" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">BitiÅŸ Tarihi</label>
                            <input type="date" id="salesDateTo" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">MÃ¼ÅŸteri Ara</label>
                            <input type="text" id="salesCustomerSearch" placeholder="MÃ¼ÅŸteri adÄ±..." class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fatura No</label>
                            <input type="text" id="salesInvoiceSearch" placeholder="INV-001..." class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        </div>
                    </div>
                    <div class="flex gap-3 mt-4">
                        <button id="clearSalesFilters" class="px-4 py-2 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors text-sm">
                            ğŸ—‘ï¸ Filtreleri Temizle
                        </button>
                        <button id="exportSalesReport" class="px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm">
                            ğŸ“Š Rapor Ä°ndir
                        </button>
                    </div>
                </div>
            </div>

            <!-- Sales Table -->
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow border dark:border-gray-700">
                <div class="p-4 border-b dark:border-gray-700">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-medium text-gray-900 dark:text-white">ğŸ“‹ SatÄ±ÅŸ Listesi</h3>
                        <div class="text-sm text-gray-500 dark:text-gray-400">
                            Toplam: <span id="filteredSalesCount" class="font-medium">0</span> satÄ±ÅŸ
                        </div>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Tarih & Saat</th>
                                <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Fatura No</th>
                                <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">ÃœrÃ¼nler</th>
                                <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">MÃ¼ÅŸteri</th>
                                <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Tutar</th>
                                <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Kar</th>
                                <th class="px-6 py-4 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody id="salesTable" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                        </tbody>
                    </table>
                </div>
                <div id="salesTableEmpty" class="hidden p-8 text-center">
                    <div class="text-gray-400 text-6xl mb-4">ğŸ“‹</div>
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-2">HenÃ¼z satÄ±ÅŸ yok</h3>
                    <p class="text-gray-500 dark:text-gray-400 mb-4">Ä°lk satÄ±ÅŸÄ±nÄ±zÄ± yapmak iÃ§in "Yeni SatÄ±ÅŸ Yap" butonuna tÄ±klayÄ±n.</p>
                    <button onclick="document.getElementById('newSaleBtn').click()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                        ğŸ’° Ä°lk SatÄ±ÅŸÄ± Yap
                    </button>
                </div>
            </div>
        </div>

        <!-- Customers Tab -->
        <div id="customers" class="tab-content hidden">
            <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4">
                <h2 class="text-2xl font-bold text-gray-900 dark:text-white">MÃ¼ÅŸteri YÃ¶netimi</h2>
                <button id="addCustomerBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                    ğŸ‘¤ Yeni MÃ¼ÅŸteri
                </button>
            </div>

            <div class="bg-white dark:bg-gray-800 rounded-lg shadow border dark:border-gray-700">
                <div class="p-4 border-b dark:border-gray-700">
                    <input type="text" id="searchCustomer" placeholder="MÃ¼ÅŸteri ara..." class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full">
                        <thead class="bg-gray-50 dark:bg-gray-700">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">MÃ¼ÅŸteri</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Telefon</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">E-posta</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Toplam AlÄ±ÅŸveriÅŸ</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider">Ä°ÅŸlemler</th>
                            </tr>
                        </thead>
                        <tbody id="customerTable" class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Reports Tab -->
        <div id="reports" class="tab-content hidden">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Raporlar ve Analizler</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 border dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">En Ã‡ok Satan ÃœrÃ¼nler</h3>
                    <div id="topProducts" class="space-y-3">
                    </div>
                </div>
                
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 border dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">Stok Durumu</h3>
                    <div id="stockStatus" class="space-y-3">
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings" class="tab-content hidden">
            <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-6">Ayarlar</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <!-- Company Settings -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 border dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">ğŸ¢ Firma Bilgileri</h3>
                    <form id="companyForm" class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Firma AdÄ±</label>
                            <input type="text" id="settingsCompanyName" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Firma adÄ±nÄ±zÄ± girin">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Telefon</label>
                            <input type="tel" id="settingsCompanyPhone" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="+90 555 123 45 67">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">E-posta</label>
                            <input type="email" id="settingsCompanyEmail" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="info@firmaniz.com">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Adres</label>
                            <textarea id="settingsCompanyAddress" rows="3" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Firma adresinizi girin"></textarea>
                        </div>
                        <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            ğŸ’¾ Firma Bilgilerini Kaydet
                        </button>
                    </form>
                </div>

                <!-- System Settings -->
                <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-6 border dark:border-gray-700">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">âš™ï¸ Sistem AyarlarÄ±</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-between">
                            <div>
                                <label class="text-sm font-medium text-gray-700 dark:text-gray-300">KaranlÄ±k Tema</label>
                                <p class="text-xs text-gray-500 dark:text-gray-400">ArayÃ¼z temasÄ±nÄ± deÄŸiÅŸtir</p>
                            </div>
                            <button id="settingsThemeToggle" class="relative inline-flex h-6 w-11 items-center rounded-full bg-gray-200 dark:bg-gray-600 transition-colors focus:outline-none">
                                <span id="settingsThemeSlider" class="inline-block h-4 w-4 transform rounded-full bg-white transition-transform translate-x-1"></span>
                            </button>
                        </div>
                        
                        <div class="border-t dark:border-gray-600 pt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Minimum Stok UyarÄ± Seviyesi</label>
                            <input type="number" id="settingsMinStock" min="1" value="5" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Bu deÄŸerin altÄ±ndaki Ã¼rÃ¼nler dÃ¼ÅŸÃ¼k stok olarak iÅŸaretlenir</p>
                        </div>

                        <div class="border-t dark:border-gray-600 pt-4">
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">Para Birimi</label>
                            <select id="settingsCurrency" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="â‚º">TÃ¼rk LirasÄ± (â‚º)</option>
                                <option value="$">Amerikan DolarÄ± ($)</option>
                                <option value="â‚¬">Euro (â‚¬)</option>
                            </select>
                        </div>

                        <button id="saveSystemSettings" class="w-full bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                            ğŸ’¾ Sistem AyarlarÄ±nÄ± Kaydet
                        </button>
                    </div>
                </div>
            </div>

            <!-- Data Management -->
            <div class="mt-6 bg-white dark:bg-gray-800 rounded-lg shadow p-6 border dark:border-gray-700">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white mb-4">ğŸ“Š Veri YÃ¶netimi</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <button id="exportData" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        ğŸ“¤ Verileri DÄ±ÅŸa Aktar
                    </button>
                    <button id="importData" class="bg-yellow-600 hover:bg-yellow-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        ğŸ“¥ Verileri Ä°Ã§e Aktar
                    </button>
                    <button id="resetData" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                        ğŸ—‘ï¸ TÃ¼m Verileri SÄ±fÄ±rla
                    </button>
                </div>
                <input type="file" id="importFile" accept=".json" class="hidden">
            </div>
        </div>
    </main>

    <!-- Product Modal -->
    <div id="productModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-lg">
            <div class="p-6 border-b dark:border-gray-700">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white">ÃœrÃ¼n Ekle/DÃ¼zenle</h3>
            </div>
            <form id="productForm" class="p-6 space-y-4">
                <input type="hidden" id="productId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ÃœrÃ¼n AdÄ±</label>
                    <input type="text" id="productName" required class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Kategori</label>
                    <select id="productCategory" required class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                        <option value="">Kategori SeÃ§in</option>
                        <option value="Telefon">Telefon</option>
                        <option value="Tablet">Tablet</option>
                        <option value="Aksesuar">Aksesuar</option>
                        <option value="KulaklÄ±k">KulaklÄ±k</option>
                        <option value="Laptop">Laptop</option>
                        <option value="Saat">AkÄ±llÄ± Saat</option>
                        <option value="Kamera">Kamera</option>
                    </select>
                </div>
                
                <!-- Product Specifications -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Marka</label>
                        <select id="productBrand" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Marka SeÃ§in</option>
                            <option value="Apple">Apple</option>
                            <option value="Samsung">Samsung</option>
                            <option value="Xiaomi">Xiaomi</option>
                            <option value="Huawei">Huawei</option>
                            <option value="Oppo">Oppo</option>
                            <option value="Vivo">Vivo</option>
                            <option value="Realme">Realme</option>
                            <option value="OnePlus">OnePlus</option>
                            <option value="Sony">Sony</option>
                            <option value="LG">LG</option>
                            <option value="DiÄŸer">DiÄŸer</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Model</label>
                        <input type="text" id="productModel" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Ã–rn: iPhone 15 Pro Max">
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Renk</label>
                        <select id="productColor" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Renk SeÃ§in</option>
                            <option value="Siyah">Siyah</option>
                            <option value="Beyaz">Beyaz</option>
                            <option value="Gri">Gri</option>
                            <option value="Space Gray">Space Gray</option>
                            <option value="Gece YarÄ±sÄ±">Gece YarÄ±sÄ±</option>
                            <option value="Mavi">Mavi</option>
                            <option value="AÃ§Ä±k Mavi">AÃ§Ä±k Mavi</option>
                            <option value="Lacivert">Lacivert</option>
                            <option value="YeÅŸil">YeÅŸil</option>
                            <option value="AÃ§Ä±k YeÅŸil">AÃ§Ä±k YeÅŸil</option>
                            <option value="Koyu YeÅŸil">Koyu YeÅŸil</option>
                            <option value="Mor">Mor</option>
                            <option value="AÃ§Ä±k Mor">AÃ§Ä±k Mor</option>
                            <option value="Koyu Mor">Koyu Mor</option>
                            <option value="KÄ±rmÄ±zÄ±">KÄ±rmÄ±zÄ±</option>
                            <option value="Pembe">Pembe</option>
                            <option value="AÃ§Ä±k Pembe">AÃ§Ä±k Pembe</option>
                            <option value="AltÄ±n">AltÄ±n</option>
                            <option value="Rose Gold">Rose Gold</option>
                            <option value="GÃ¼mÃ¼ÅŸ">GÃ¼mÃ¼ÅŸ</option>
                            <option value="Bronz">Bronz</option>
                            <option value="Titanyum">Titanyum</option>
                            <option value="SarÄ±">SarÄ±</option>
                            <option value="Turuncu">Turuncu</option>
                            <option value="Kahverengi">Kahverengi</option>
                            <option value="Coral">Coral</option>
                            <option value="Mint">Mint</option>
                            <option value="Lavanta">Lavanta</option>
                            <option value="DiÄŸer">DiÄŸer</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">HafÄ±za (GB)</label>
                        <select id="productStorage" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">HafÄ±za SeÃ§in</option>
                            <option value="32">32 GB</option>
                            <option value="64">64 GB</option>
                            <option value="128">128 GB</option>
                            <option value="256">256 GB</option>
                            <option value="512">512 GB</option>
                            <option value="1024">1 TB</option>
                            <option value="2048">2 TB</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">RAM (GB)</label>
                        <select id="productRam" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">RAM SeÃ§in</option>
                            <option value="2">2 GB</option>
                            <option value="3">3 GB</option>
                            <option value="4">4 GB</option>
                            <option value="6">6 GB</option>
                            <option value="8">8 GB</option>
                            <option value="12">12 GB</option>
                            <option value="16">16 GB</option>
                            <option value="18">18 GB</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Durum</label>
                        <select id="productCondition" required class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Durum SeÃ§in</option>
                            <option value="SÄ±fÄ±r">SÄ±fÄ±r</option>
                            <option value="SÄ±fÄ±r AyarÄ±nda">SÄ±fÄ±r AyarÄ±nda</option>
                            <option value="Az KullanÄ±lmÄ±ÅŸ">Az KullanÄ±lmÄ±ÅŸ</option>
                            <option value="Ä°yi Durumda">Ä°yi Durumda</option>
                            <option value="Orta Durumda">Orta Durumda</option>
                            <option value="HasarlÄ±">HasarlÄ±</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Garanti</label>
                        <select id="productWarranty" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Garanti Durumu</option>
                            <option value="Yok">Garanti Yok</option>
                            <option value="3 Ay">3 Ay MaÄŸaza Garantisi</option>
                            <option value="6 Ay">6 Ay MaÄŸaza Garantisi</option>
                            <option value="1 YÄ±l">1 YÄ±l MaÄŸaza Garantisi</option>
                            <option value="Apple TÃ¼rkiye">Apple TÃ¼rkiye Garantisi</option>
                            <option value="Samsung TÃ¼rkiye">Samsung TÃ¼rkiye Garantisi</option>
                            <option value="DistribÃ¼tÃ¶r">DistribÃ¼tÃ¶r Garantisi</option>
                            <option value="Ä°thalatÃ§Ä±">Ä°thalatÃ§Ä± Garantisi</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Stok MiktarÄ±</label>
                        <input type="number" id="productStock" required min="0" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Minimum Stok</label>
                        <input type="number" id="productMinStock" min="0" value="5" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    </div>
                </div>

                <!-- Additional Features -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Pil Durumu (%)</label>
                        <select id="productBattery" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Pil Durumu SeÃ§in</option>
                            <option value="100">100% (Yeni)</option>
                            <option value="95-99">95-99% (MÃ¼kemmel)</option>
                            <option value="90-94">90-94% (Ã‡ok Ä°yi)</option>
                            <option value="85-89">85-89% (Ä°yi)</option>
                            <option value="80-84">80-84% (Orta)</option>
                            <option value="75-79">75-79% (DÃ¼ÅŸÃ¼k)</option>
                            <option value="70-74">70-74% (ZayÄ±f)</option>
                            <option value="<70">%70'in AltÄ±nda</option>
                            <option value="DeÄŸiÅŸtirildi">Pil DeÄŸiÅŸtirildi</option>
                            <option value="Bilinmiyor">Bilinmiyor</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ekran Durumu</label>
                        <select id="productScreen" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Ekran Durumu</option>
                            <option value="MÃ¼kemmel">MÃ¼kemmel</option>
                            <option value="Ã‡ok Ä°yi">Ã‡ok Ä°yi</option>
                            <option value="Ä°yi">Ä°yi</option>
                            <option value="Hafif Ã‡izik">Hafif Ã‡izik</option>
                            <option value="Ã‡izikli">Ã‡izikli</option>
                            <option value="KÄ±rÄ±k">KÄ±rÄ±k</option>
                            <option value="DeÄŸiÅŸtirildi">Ekran DeÄŸiÅŸtirildi</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Kasa Durumu</label>
                        <select id="productCase" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Kasa Durumu</option>
                            <option value="MÃ¼kemmel">MÃ¼kemmel</option>
                            <option value="Ã‡ok Ä°yi">Ã‡ok Ä°yi</option>
                            <option value="Ä°yi">Ä°yi</option>
                            <option value="Hafif Ã‡izik">Hafif Ã‡izik</option>
                            <option value="Ã‡izikli">Ã‡izikli</option>
                            <option value="Ezik">Ezik</option>
                            <option value="HasarlÄ±">HasarlÄ±</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Kutu/Aksesuar</label>
                        <select id="productBox" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">Kutu Durumu</option>
                            <option value="Tam Kutulu">Tam Kutulu</option>
                            <option value="Kutu + Åarj Aleti">Kutu + Åarj Aleti</option>
                            <option value="Kutu + Kablo">Kutu + Kablo</option>
                            <option value="Sadece Kutu">Sadece Kutu</option>
                            <option value="Kutusuz">Kutusuz</option>
                            <option value="Sadece Åarj Aleti">Sadece Åarj Aleti</option>
                            <option value="Aksesuar Yok">Aksesuar Yok</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">SIM Durumu</label>
                        <select id="productSim" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                            <option value="">SIM Durumu</option>
                            <option value="AÃ§Ä±k">AÃ§Ä±k (Unlocked)</option>
                            <option value="Turkcell">Turkcell Kilitli</option>
                            <option value="Vodafone">Vodafone Kilitli</option>
                            <option value="TÃ¼rk Telekom">TÃ¼rk Telekom Kilitli</option>
                            <option value="Bilinmiyor">Bilinmiyor</option>
                        </select>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ä°ÅŸletim Sistemi</label>
                        <input type="text" id="productOS" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Ã–rn: iOS 17.2, Android 14">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ã–zel Ã–zellikler</label>
                        <input type="text" id="productFeatures" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Face ID, Touch ID, 5G, vb.">
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">AÃ§Ä±klama/Notlar</label>
                    <textarea id="productDescription" rows="2" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="ÃœrÃ¼n hakkÄ±nda ek bilgiler, kusurlar, Ã¶zellikler vb."></textarea>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">AlÄ±ÅŸ FiyatÄ± (â‚º)</label>
                        <input type="number" id="productCostPrice" required min="0" step="0.01" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">SatÄ±ÅŸ FiyatÄ± (â‚º)</label>
                        <input type="number" id="productPrice" required min="0" step="0.01" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                    </div>
                </div>
                <div id="serialNumberSection" class="hidden">
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Seri NumaralarÄ±</label>
                    <div id="serialNumbers" class="space-y-2">
                        <div class="flex gap-2">
                            <input type="text" class="serial-input flex-1 px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Seri numarasÄ± girin">
                            <button type="button" class="add-serial bg-green-600 hover:bg-green-700 text-white px-3 py-2 rounded-lg text-sm">+</button>
                        </div>
                    </div>
                    <p class="text-xs text-gray-500 dark:text-gray-400 mt-1">Her telefon iÃ§in ayrÄ± seri numarasÄ± ekleyin</p>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="cancelProduct" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">Ä°ptal</button>
                    <button type="submit" class="bg-primary hover:bg-blue-700 text-white px-4 py-2 rounded-lg">Kaydet</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sale Modal -->
    <div id="saleModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl">
            <div class="p-6 border-b dark:border-gray-700">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white">Yeni SatÄ±ÅŸ</h3>
            </div>
            <form id="saleForm" class="p-6">
                <div class="grid grid-cols-2 gap-6 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">MÃ¼ÅŸteri <span class="text-red-500">*</span></label>
                        <div class="flex gap-2">
                            <select id="saleCustomer" required class="flex-1 px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                                <option value="">MÃ¼ÅŸteri SeÃ§in (Zorunlu)</option>
                            </select>
                            <button type="button" id="addNewCustomerBtn" class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-2 rounded-lg text-sm whitespace-nowrap">
                                + Yeni MÃ¼ÅŸteri
                            </button>
                        </div>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Fatura No</label>
                        <input type="text" id="invoiceNumber" readonly class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-gray-100 dark:bg-gray-600 text-gray-900 dark:text-white">
                    </div>
                </div>
                
                <!-- Sale Items -->
                <div class="mb-6">
                    <div class="flex justify-between items-center mb-4">
                        <h4 class="text-md font-medium text-gray-900 dark:text-white">SatÄ±ÅŸ Kalemleri</h4>
                        <button type="button" id="addSaleItem" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm">+ ÃœrÃ¼n Ekle</button>
                    </div>
                    <div id="saleItems" class="space-y-3">
                        <div class="sale-item grid grid-cols-12 gap-2 items-center">
                            <div class="col-span-5">
                                <select class="sale-product w-full px-2 py-1 border dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm">
                                    <option value="">ÃœrÃ¼n SeÃ§in</option>
                                </select>
                            </div>
                            <div class="col-span-2">
                                <input type="number" class="sale-quantity w-full px-2 py-1 border dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm" min="1" value="1">
                            </div>
                            <div class="col-span-2">
                                <input type="number" class="sale-price w-full px-2 py-1 border dark:border-gray-600 rounded bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm" step="0.01">
                            </div>
                            <div class="col-span-2">
                                <span class="sale-total text-sm font-medium">â‚º0</span>
                            </div>
                            <div class="col-span-1">
                                <button type="button" class="remove-item text-red-600 hover:text-red-800 text-sm">Ã—</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Sale Summary -->
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4 mb-6">
                    <div class="flex justify-between items-center text-lg font-bold">
                        <span>Toplam:</span>
                        <span id="grandTotal">â‚º0</span>
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" id="cancelSale" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">Ä°ptal</button>
                    <button type="submit" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg">ğŸ’° SatÄ±ÅŸ Yap ve FiÅŸ YazdÄ±r</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Serial Numbers Modal -->
    <div id="serialModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md">
            <div class="p-6 border-b dark:border-gray-700">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white">Seri NumaralarÄ±</h3>
            </div>
            <div class="p-6">
                <div id="serialList" class="space-y-2 max-h-64 overflow-y-auto">
                </div>
                <div class="flex justify-end pt-4">
                    <button id="closeSerialModal" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">Kapat</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Customer Modal -->
    <div id="customerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md">
            <div class="p-6 border-b dark:border-gray-700">
                <h3 class="text-lg font-medium text-gray-900 dark:text-white">MÃ¼ÅŸteri Ekle/DÃ¼zenle</h3>
            </div>
            <form id="customerForm" class="p-6 space-y-4">
                <input type="hidden" id="customerId">
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ad Soyad</label>
                    <input type="text" id="customerName" required class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Telefon</label>
                    <input type="tel" id="customerPhone" required class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">E-posta</label>
                    <input type="email" id="customerEmail" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Adres</label>
                    <textarea id="customerAddress" rows="3" class="w-full px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white"></textarea>
                </div>
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" id="cancelCustomer" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">Ä°ptal</button>
                    <button type="submit" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg">Kaydet</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sale Detail Modal -->
    <div id="saleDetailModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="p-6 border-b dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-800">
                <div class="flex justify-between items-center">
                    <h3 class="text-lg font-medium text-gray-900 dark:text-white">ğŸ“‹ SatÄ±ÅŸ DetaylarÄ±</h3>
                    <button id="closeSaleDetail" class="text-gray-400 hover:text-gray-600 dark:hover:text-gray-300">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <!-- Sale Info -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4">
                        <h4 class="font-medium text-blue-900 dark:text-blue-300 mb-3">ğŸ’¼ SatÄ±ÅŸ Bilgileri</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600 dark:text-gray-400">Fatura No:</span>
                                <span class="font-medium text-gray-900 dark:text-white" id="detailInvoiceNumber">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600 dark:text-gray-400">Tarih:</span>
                                <span class="font-medium text-gray-900 dark:text-white" id="detailDate">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600 dark:text-gray-400">Saat:</span>
                                <span class="font-medium text-gray-900 dark:text-white" id="detailTime">-</span>
                            </div>
                        </div>
                    </div>
                    <div class="bg-green-50 dark:bg-green-900/20 rounded-lg p-4">
                        <h4 class="font-medium text-green-900 dark:text-green-300 mb-3">ğŸ‘¤ MÃ¼ÅŸteri Bilgileri</h4>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between">
                                <span class="text-gray-600 dark:text-gray-400">Ad Soyad:</span>
                                <span class="font-medium text-gray-900 dark:text-white" id="detailCustomerName">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600 dark:text-gray-400">Telefon:</span>
                                <span class="font-medium text-gray-900 dark:text-white" id="detailCustomerPhone">-</span>
                            </div>
                            <div class="flex justify-between">
                                <span class="text-gray-600 dark:text-gray-400">E-posta:</span>
                                <span class="font-medium text-gray-900 dark:text-white" id="detailCustomerEmail">-</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Products Table -->
                <div class="mb-6">
                    <h4 class="font-medium text-gray-900 dark:text-white mb-3">ğŸ›ï¸ SatÄ±lan ÃœrÃ¼nler</h4>
                    <div class="overflow-x-auto">
                        <table class="w-full border border-gray-200 dark:border-gray-700 rounded-lg">
                            <thead class="bg-gray-50 dark:bg-gray-700">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">ÃœrÃ¼n</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Adet</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Birim Fiyat</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Toplam</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase">Kar</th>
                                </tr>
                            </thead>
                            <tbody id="detailProductsTable" class="divide-y divide-gray-200 dark:divide-gray-700">
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Summary -->
                <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-4">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="text-center">
                            <div class="text-2xl font-bold text-blue-600" id="detailTotalAmount">â‚º0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Toplam Tutar</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-green-600" id="detailTotalProfit">â‚º0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Toplam Kar</div>
                        </div>
                        <div class="text-center">
                            <div class="text-2xl font-bold text-purple-600" id="detailProfitMargin">%0</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">Kar MarjÄ±</div>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="flex justify-end gap-3 mt-6 pt-4 border-t dark:border-gray-700">
                    <button id="printDetailReceipt" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                        ğŸ“„ FiÅŸ YazdÄ±r
                    </button>
                    <button id="closeSaleDetailBtn" class="px-4 py-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200">
                        Kapat
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data Storage
        let products = JSON.parse(localStorage.getItem('stokpro_products')) || [];
        let customers = JSON.parse(localStorage.getItem('stokpro_customers')) || [];
        let sales = JSON.parse(localStorage.getItem('stokpro_sales')) || [];
        let settings = JSON.parse(localStorage.getItem('stokpro_settings')) || {
            companyName: 'EYMEN MOBILE ELEKTRONÄ°K',
            companyPhone: '+90 555 123 45 67',
            companyEmail: '',
            companyAddress: '',
            minStock: 5,
            currency: 'â‚º',
            theme: 'light'
        };

        // Initialize with sample data
        if (products.length === 0) {
            products = [
                { 
                    id: 1, 
                    name: 'iPhone 15 Pro', 
                    category: 'Telefon', 
                    brand: 'Apple',
                    model: 'iPhone 15 Pro',
                    color: 'Titanyum',
                    storage: '256',
                    ram: '8',
                    condition: 'SÄ±fÄ±r',
                    warranty: 'Apple TÃ¼rkiye',
                    battery: '100',
                    screen: 'MÃ¼kemmel',
                    case: 'MÃ¼kemmel',
                    box: 'Tam Kutulu',
                    sim: 'AÃ§Ä±k',
                    os: 'iOS 17.2',
                    features: 'Face ID, 5G, ProRAW',
                    description: 'Titanium kasa, A17 Pro Ã§ip, Action Button',
                    stock: 15, 
                    costPrice: 35000, 
                    price: 45000, 
                    sold: 8, 
                    minStock: 5, 
                    serialNumbers: ['IP15P001', 'IP15P002', 'IP15P003'] 
                },
                { 
                    id: 2, 
                    name: 'Samsung Galaxy S24', 
                    category: 'Telefon', 
                    brand: 'Samsung',
                    model: 'Galaxy S24',
                    color: 'AÃ§Ä±k Mor',
                    storage: '128',
                    ram: '8',
                    condition: 'SÄ±fÄ±r',
                    warranty: 'Samsung TÃ¼rkiye',
                    battery: '100',
                    screen: 'MÃ¼kemmel',
                    case: 'MÃ¼kemmel',
                    box: 'Tam Kutulu',
                    sim: 'AÃ§Ä±k',
                    os: 'Android 14',
                    features: 'Galaxy AI, S Pen uyumlu',
                    description: 'AI Ã¶zellikli kamera, 120Hz ekran',
                    stock: 3, 
                    costPrice: 25000, 
                    price: 35000, 
                    sold: 12, 
                    minStock: 5, 
                    serialNumbers: ['SGS24001', 'SGS24002'] 
                },
                { 
                    id: 3, 
                    name: 'iPad Air', 
                    category: 'Tablet', 
                    brand: 'Apple',
                    model: 'iPad Air 5',
                    color: 'GÃ¼mÃ¼ÅŸ',
                    storage: '256',
                    ram: '8',
                    condition: 'SÄ±fÄ±r',
                    warranty: 'Apple TÃ¼rkiye',
                    battery: '100',
                    screen: 'MÃ¼kemmel',
                    case: 'MÃ¼kemmel',
                    box: 'Tam Kutulu',
                    os: 'iPadOS 17',
                    features: 'Apple Pencil 2 uyumlu, M1 Ã§ip',
                    description: 'M1 Ã§ipli, 10.9 inÃ§ Liquid Retina ekran',
                    stock: 8, 
                    costPrice: 18000, 
                    price: 25000, 
                    sold: 5, 
                    minStock: 3 
                },
                { 
                    id: 4, 
                    name: 'AirPods Pro', 
                    category: 'KulaklÄ±k', 
                    brand: 'Apple',
                    model: 'AirPods Pro 2',
                    color: 'Beyaz',
                    storage: '',
                    ram: '',
                    condition: 'SÄ±fÄ±r',
                    warranty: 'Apple TÃ¼rkiye',
                    battery: '100',
                    case: 'MÃ¼kemmel',
                    box: 'Tam Kutulu',
                    features: 'ANC, Spatial Audio, MagSafe',
                    description: 'Aktif gÃ¼rÃ¼ltÃ¼ engelleme, H2 Ã§ip',
                    stock: 25, 
                    costPrice: 6000, 
                    price: 8500, 
                    sold: 15, 
                    minStock: 10 
                },
                { 
                    id: 5, 
                    name: 'iPhone 13', 
                    category: 'Telefon', 
                    brand: 'Apple',
                    model: 'iPhone 13',
                    color: 'Mavi',
                    storage: '128',
                    ram: '4',
                    condition: 'Az KullanÄ±lmÄ±ÅŸ',
                    warranty: '6 Ay',
                    battery: '90-94',
                    screen: 'Ã‡ok Ä°yi',
                    case: 'Ä°yi',
                    box: 'Kutu + Åarj Aleti',
                    sim: 'AÃ§Ä±k',
                    os: 'iOS 17.1',
                    features: 'Face ID, Cinematic Mode',
                    description: 'Temiz, hafif kullanÄ±m izleri',
                    stock: 2, 
                    costPrice: 18000, 
                    price: 22000, 
                    sold: 30, 
                    minStock: 5,
                    serialNumbers: ['IP13001', 'IP13002']
                }
            ];
            saveData();
        }

        if (customers.length === 0) {
            customers = [
                { id: 1, name: 'Ahmet YÄ±lmaz', phone: '0532 123 45 67', email: 'ahmet@email.com', address: 'KadÄ±kÃ¶y, Ä°stanbul', totalPurchases: 45000 },
                { id: 2, name: 'Fatma Demir', phone: '0541 987 65 43', email: 'fatma@email.com', address: 'BeÅŸiktaÅŸ, Ä°stanbul', totalPurchases: 8500 },
                { id: 3, name: 'Mehmet Kaya', phone: '0555 111 22 33', email: 'mehmet@email.com', address: 'ÃœskÃ¼dar, Ä°stanbul', totalPurchases: 25000 }
            ];
            saveData();
        }

        if (sales.length === 0) {
            const today = new Date().toISOString().split('T')[0];
            sales = [
                { id: 1, invoiceNumber: 'INV-001', items: [{productId: 1, quantity: 1, price: 45000}], customerId: 1, total: 45000, date: today, time: '14:30' },
                { id: 2, invoiceNumber: 'INV-002', items: [{productId: 4, quantity: 1, price: 8500}], customerId: 2, total: 8500, date: today, time: '15:45' },
                { id: 3, invoiceNumber: 'INV-003', items: [{productId: 3, quantity: 1, price: 25000}], customerId: 3, total: 25000, date: '2024-01-15', time: '10:20' }
            ];
            saveData();
        }

        // Theme Management
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const isDark = localStorage.getItem('theme') === 'dark' || settings.theme === 'dark';

        if (isDark) {
            document.documentElement.classList.add('dark');
            themeIcon.textContent = 'â˜€ï¸';
        }

        themeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDarkMode = document.documentElement.classList.contains('dark');
            themeIcon.textContent = isDarkMode ? 'â˜€ï¸' : 'ğŸŒ™';
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
            settings.theme = isDarkMode ? 'dark' : 'light';
            saveData();
        });

        // Company Info Update
        function updateCompanyDisplay() {
            document.getElementById('companyName').textContent = settings.companyName;
            document.getElementById('companyPhone').textContent = settings.companyPhone;
        }

        // Tab Management
        const navBtns = document.querySelectorAll('.nav-btn');
        const tabContents = document.querySelectorAll('.tab-content');

        navBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.dataset.tab;
                
                navBtns.forEach(b => {
                    b.classList.remove('border-primary', 'text-primary');
                    b.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');
                });
                
                btn.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'dark:text-gray-400', 'dark:hover:text-gray-300');
                btn.classList.add('border-primary', 'text-primary');
                
                tabContents.forEach(content => content.classList.add('hidden'));
                document.getElementById(tabId).classList.remove('hidden');
                
                // Load tab-specific content
                switch(tabId) {
                    case 'dashboard':
                        updateDashboard();
                        break;
                    case 'inventory':
                        renderProducts();
                        break;
                    case 'sales':
                        renderSales();
                        break;
                    case 'customers':
                        renderCustomers();
                        break;
                    case 'reports':
                        renderReports();
                        break;
                    case 'settings':
                        loadSettings();
                        break;
                }
            });
        });

        // Save Data Function
        function saveData() {
            localStorage.setItem('stokpro_products', JSON.stringify(products));
            localStorage.setItem('stokpro_customers', JSON.stringify(customers));
            localStorage.setItem('stokpro_sales', JSON.stringify(sales));
            localStorage.setItem('stokpro_settings', JSON.stringify(settings));
        }

        // Settings Functions
        function loadSettings() {
            document.getElementById('settingsCompanyName').value = settings.companyName;
            document.getElementById('settingsCompanyPhone').value = settings.companyPhone;
            document.getElementById('settingsCompanyEmail').value = settings.companyEmail || '';
            document.getElementById('settingsCompanyAddress').value = settings.companyAddress || '';
            document.getElementById('settingsMinStock').value = settings.minStock;
            document.getElementById('settingsCurrency').value = settings.currency;
            
            // Update theme toggle
            const isDark = document.documentElement.classList.contains('dark');
            const slider = document.getElementById('settingsThemeSlider');
            const toggle = document.getElementById('settingsThemeToggle');
            
            if (isDark) {
                slider.classList.add('translate-x-6');
                toggle.classList.add('bg-blue-600');
                toggle.classList.remove('bg-gray-200');
            } else {
                slider.classList.remove('translate-x-6');
                toggle.classList.remove('bg-blue-600');
                toggle.classList.add('bg-gray-200');
            }
        }

        // Dashboard Functions
        function updateDashboard() {
            const totalProducts = products.reduce((sum, p) => sum + p.stock, 0);
            const lowStockCount = products.filter(p => p.stock <= (p.minStock || settings.minStock)).length;
            const todaySales = getTodaySales();
            const totalProfit = calculateTotalProfit();
            
            document.getElementById('totalProducts').textContent = totalProducts;
            document.getElementById('quickTotalProducts').textContent = totalProducts;
            document.getElementById('lowStock').textContent = lowStockCount;
            document.getElementById('quickLowStock').textContent = lowStockCount;
            document.getElementById('todaySales').textContent = `${settings.currency}${todaySales.toLocaleString('tr-TR')}`;
            document.getElementById('quickTodaySales').textContent = `${settings.currency}${todaySales.toLocaleString('tr-TR')}`;
            document.getElementById('totalProfit').textContent = `${settings.currency}${totalProfit.toLocaleString('tr-TR')}`;
            
            renderRecentSales();
        }

        function getTodaySales() {
            const today = new Date().toISOString().split('T')[0];
            return sales.filter(s => s.date === today).reduce((sum, s) => sum + s.total, 0);
        }

        function calculateTotalProfit() {
            return sales.reduce((totalProfit, sale) => {
                return totalProfit + sale.items.reduce((saleProfit, item) => {
                    const product = products.find(p => p.id === item.productId);
                    if (product) {
                        const profit = (item.price - (product.costPrice || 0)) * item.quantity;
                        return saleProfit + profit;
                    }
                    return saleProfit;
                }, 0);
            }, 0);
        }

        function renderRecentSales() {
            const container = document.getElementById('recentSales');
            const recentSales = sales.slice(-10).reverse();
            
            container.innerHTML = recentSales.map(sale => {
                const customer = sale.customerId ? customers.find(c => c.id === sale.customerId) : null;
                const productNames = sale.items.map(item => {
                    const product = products.find(p => p.id === item.productId);
                    return product ? product.name : 'SilinmiÅŸ ÃœrÃ¼n';
                }).join(', ');
                
                return `
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div>
                            <div class="font-medium text-gray-900 dark:text-white">${productNames}</div>
                            <div class="text-sm text-gray-500 dark:text-gray-400">
                                ${customer ? customer.name : (sale.customerId ? 'SilinmiÅŸ MÃ¼ÅŸteri' : 'MÃ¼ÅŸteri SeÃ§ilmedi')} - ${sale.date} ${sale.time}
                            </div>
                        </div>
                        <div class="text-green-600 font-medium">${settings.currency}${sale.total.toLocaleString('tr-TR')}</div>
                    </div>
                `;
            }).join('');
        }

        // Product Management
        function renderProducts() {
            const tbody = document.getElementById('productTable');
            const searchTerm = document.getElementById('searchProduct').value.toLowerCase();
            const categoryFilter = document.getElementById('categoryFilter').value;
            const brandFilter = document.getElementById('brandFilter').value;
            const conditionFilter = document.getElementById('conditionFilter').value;
            const stockFilter = document.getElementById('stockFilter').value;
            const colorFilter = document.getElementById('colorFilter').value;
            
            let filteredProducts = products.filter(product => {
                const matchesSearch = product.name.toLowerCase().includes(searchTerm) ||
                                    (product.brand && product.brand.toLowerCase().includes(searchTerm)) ||
                                    (product.model && product.model.toLowerCase().includes(searchTerm)) ||
                                    (product.description && product.description.toLowerCase().includes(searchTerm));
                const matchesCategory = !categoryFilter || product.category === categoryFilter;
                const matchesBrand = !brandFilter || product.brand === brandFilter;
                const matchesCondition = !conditionFilter || product.condition === conditionFilter;
                const matchesColor = !colorFilter || product.color === colorFilter;
                let matchesStock = true;
                
                if (stockFilter === 'out') matchesStock = product.stock === 0;
                else if (stockFilter === 'low') matchesStock = product.stock > 0 && product.stock < 5;
                else if (stockFilter === 'normal') matchesStock = product.stock >= 5;
                
                return matchesSearch && matchesCategory && matchesBrand && matchesCondition && matchesColor && matchesStock;
            });
            
            tbody.innerHTML = filteredProducts.map(product => {
                const profit = product.price - (product.costPrice || 0);
                
                // Build specifications display
                const specs = [];
                if (product.brand) specs.push(product.brand);
                if (product.color) specs.push(product.color);
                if (product.storage) specs.push(`${product.storage}GB`);
                if (product.ram) specs.push(`${product.ram}GB RAM`);
                const specsText = specs.join(' â€¢ ');
                
                // Condition badge color
                const conditionColors = {
                    'SÄ±fÄ±r': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
                    'SÄ±fÄ±r AyarÄ±nda': 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200',
                    'Az KullanÄ±lmÄ±ÅŸ': 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
                    'Ä°yi Durumda': 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200',
                    'Orta Durumda': 'bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200',
                    'HasarlÄ±': 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'
                };
                
                return `
                    <tr>
                        <td class="px-6 py-4">
                            <div class="text-sm font-medium text-gray-900 dark:text-white">${product.name}</div>
                            <div class="text-xs text-gray-500 dark:text-gray-400">${product.category}</div>
                            ${product.description ? `<div class="text-xs text-gray-400 mt-1 max-w-48 truncate" title="${product.description}">${product.description}</div>` : ''}
                        </td>
                        <td class="px-6 py-4">
                            <div class="text-xs text-gray-900 dark:text-white">${specsText || '-'}</div>
                            ${product.warranty ? `<div class="text-xs text-gray-500 dark:text-gray-400 mt-1">ğŸ“‹ ${product.warranty}</div>` : ''}
                            ${product.battery ? `<div class="text-xs text-green-600 dark:text-green-400 mt-1">ğŸ”‹ ${product.battery}</div>` : ''}
                            ${product.screen ? `<div class="text-xs text-blue-600 dark:text-blue-400 mt-1">ğŸ“± ${product.screen}</div>` : ''}
                            ${product.sim ? `<div class="text-xs text-purple-600 dark:text-purple-400 mt-1">ğŸ“¶ ${product.sim}</div>` : ''}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${conditionColors[product.condition] || 'bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200'}">
                                ${product.condition || 'BelirtilmemiÅŸ'}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="text-sm ${product.stock <= (product.minStock || settings.minStock) ? 'text-red-600 font-bold' : 'text-gray-900 dark:text-white'}">${product.stock}</span>
                        </td>
                        <td class="px-6 py-4 text-sm text-gray-900 dark:text-white">
                            ${product.category === 'Telefon' && product.serialNumbers && product.serialNumbers.length > 0 ? 
                                `<div class="max-w-32 overflow-hidden">
                                    <button onclick="showSerialNumbers(${product.id})" class="text-blue-600 hover:text-blue-800 text-xs">
                                        ${product.serialNumbers.length} seri no
                                    </button>
                                </div>` : 
                                '<span class="text-gray-400 text-xs">-</span>'
                            }
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                            ${settings.currency}${(product.costPrice || 0).toLocaleString('tr-TR')}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                            ${settings.currency}${product.price.toLocaleString('tr-TR')}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600">
                            ${settings.currency}${profit.toLocaleString('tr-TR')}
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                            <button onclick="editProduct(${product.id})" class="text-blue-600 hover:text-blue-900 mr-3">DÃ¼zenle</button>
                            <button onclick="deleteProduct(${product.id})" class="text-red-600 hover:text-red-900">Sil</button>
                        </td>
                    </tr>
                `;
            }).join('');
        }

        // Sales Management
        function renderSales() {
            updateSalesStats();
            const tbody = document.getElementById('salesTable');
            const emptyState = document.getElementById('salesTableEmpty');
            const dateFrom = document.getElementById('salesDateFrom').value;
            const dateTo = document.getElementById('salesDateTo').value;
            const customerSearch = document.getElementById('salesCustomerSearch').value.toLowerCase();
            const invoiceSearch = document.getElementById('salesInvoiceSearch').value.toLowerCase();
            
            let filteredSales = sales.filter(sale => {
                let matchesDate = true;
                if (dateFrom && sale.date < dateFrom) matchesDate = false;
                if (dateTo && sale.date > dateTo) matchesDate = false;
                
                let matchesCustomer = true;
                if (customerSearch) {
                    const customer = sale.customerId ? customers.find(c => c.id === sale.customerId) : null;
                    const customerName = customer ? customer.name.toLowerCase() : '';
                    matchesCustomer = customerName.includes(customerSearch);
                }
                
                let matchesInvoice = true;
                if (invoiceSearch) {
                    matchesInvoice = sale.invoiceNumber.toLowerCase().includes(invoiceSearch);
                }
                
                return matchesDate && matchesCustomer && matchesInvoice;
            });
            
            // Update filtered count
            document.getElementById('filteredSalesCount').textContent = filteredSales.length;
            
            if (filteredSales.length === 0) {
                tbody.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            const salesWithDetails = filteredSales.map(sale => {
                const customer = sale.customerId ? customers.find(c => c.id === sale.customerId) : null;
                const productNames = sale.items.map(item => {
                    const product = products.find(p => p.id === item.productId);
                    return product ? `${product.name} (${item.quantity})` : `SilinmiÅŸ ÃœrÃ¼n (${item.quantity})`;
                }).join(', ');
                
                // Calculate profit for this sale
                const saleProfit = sale.items.reduce((profit, item) => {
                    const product = products.find(p => p.id === item.productId);
                    if (product) {
                        return profit + ((item.price - (product.costPrice || 0)) * item.quantity);
                    }
                    // For deleted products, assume 0 cost (full price as profit)
                    return profit + (item.price * item.quantity);
                }, 0);
                
                return {
                    ...sale,
                    productNames,
                    customerName: customer ? customer.name : (sale.customerId ? 'SilinmiÅŸ MÃ¼ÅŸteri' : 'MÃ¼ÅŸteri SeÃ§ilmedi'),
                    profit: saleProfit
                };
            }).sort((a, b) => new Date(b.date + ' ' + b.time) - new Date(a.date + ' ' + a.time));
            
            tbody.innerHTML = salesWithDetails.map(sale => `
                <tr class="hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                        <div class="font-medium">${new Date(sale.date).toLocaleDateString('tr-TR')}</div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">${sale.time}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">
                            ${sale.invoiceNumber}
                        </span>
                    </td>
                    <td class="px-6 py-4 text-sm text-gray-900 dark:text-white">
                        <div class="max-w-xs truncate" title="${sale.productNames}">
                            ${sale.productNames}
                        </div>
                        <div class="text-xs text-gray-500 dark:text-gray-400 mt-1">
                            ${sale.items.length} Ã¼rÃ¼n
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-purple-100 dark:bg-purple-900 rounded-full flex items-center justify-center mr-3">
                                <span class="text-purple-600 dark:text-purple-300 text-xs font-medium">
                                    ${sale.customerName.charAt(0).toUpperCase()}
                                </span>
                            </div>
                            <div>
                                <div class="font-medium">${sale.customerName}</div>
                            </div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="text-green-600 text-lg">${settings.currency}${sale.total.toLocaleString('tr-TR')}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="text-orange-600 text-lg">${settings.currency}${sale.profit.toLocaleString('tr-TR')}</div>
                        <div class="text-xs text-gray-500 dark:text-gray-400">
                            %${sale.total > 0 ? ((sale.profit / sale.total) * 100).toFixed(1) : '0'} marj
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <div class="flex gap-2">
                            <button onclick="viewSaleDetails(${sale.id})" class="inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md text-blue-700 bg-blue-100 hover:bg-blue-200 dark:bg-blue-900 dark:text-blue-300 dark:hover:bg-blue-800 transition-colors">
                                ğŸ‘ï¸ Detay
                            </button>
                            <button onclick="printReceipt(${sale.id})" class="inline-flex items-center px-3 py-1 border border-transparent text-xs font-medium rounded-md text-green-700 bg-green-100 hover:bg-green-200 dark:bg-green-900 dark:text-green-300 dark:hover:bg-green-800 transition-colors">
                                ğŸ“„ FiÅŸ
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }

        function updateSalesStats() {
            const today = new Date().toISOString().split('T')[0];
            const thisWeek = getWeekStart(new Date()).toISOString().split('T')[0];
            const thisMonth = new Date().toISOString().slice(0, 7);
            
            const todayStats = getSalesStats(s => s.date === today);
            const weekStats = getSalesStats(s => s.date >= thisWeek);
            const monthStats = getSalesStats(s => s.date.startsWith(thisMonth));
            const totalProfit = calculateTotalProfit();
            
            document.getElementById('todayTotal').textContent = `${settings.currency}${todayStats.total.toLocaleString('tr-TR')}`;
            document.getElementById('todayCount').textContent = `${todayStats.count} satÄ±ÅŸ`;
            document.getElementById('weekTotal').textContent = `${settings.currency}${weekStats.total.toLocaleString('tr-TR')}`;
            document.getElementById('weekCount').textContent = `${weekStats.count} satÄ±ÅŸ`;
            document.getElementById('monthTotal').textContent = `${settings.currency}${monthStats.total.toLocaleString('tr-TR')}`;
            document.getElementById('monthCount').textContent = `${monthStats.count} satÄ±ÅŸ`;
            document.getElementById('totalSalesProfit').textContent = `${settings.currency}${totalProfit.toLocaleString('tr-TR')}`;
        }

        function getSalesStats(filterFn) {
            const filteredSales = sales.filter(filterFn);
            return {
                total: filteredSales.reduce((sum, s) => sum + s.total, 0),
                count: filteredSales.length
            };
        }

        function getWeekStart(date) {
            const d = new Date(date);
            const day = d.getDay();
            const diff = d.getDate() - day + (day === 0 ? -6 : 1);
            return new Date(d.setDate(diff));
        }

        // Customer Management
        function renderCustomers() {
            const tbody = document.getElementById('customerTable');
            const searchTerm = document.getElementById('searchCustomer').value.toLowerCase();
            
            const filteredCustomers = customers.filter(customer =>
                customer.name.toLowerCase().includes(searchTerm) ||
                customer.phone.includes(searchTerm) ||
                (customer.email && customer.email.toLowerCase().includes(searchTerm))
            );
            
            tbody.innerHTML = filteredCustomers.map(customer => `
                <tr>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="text-sm font-medium text-gray-900 dark:text-white">${customer.name}</div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                        ${customer.phone}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white">
                        ${customer.email || '-'}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600">
                        ${settings.currency}${customer.totalPurchases.toLocaleString('tr-TR')}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="editCustomer(${customer.id})" class="text-blue-600 hover:text-blue-900 mr-3">DÃ¼zenle</button>
                        <button onclick="deleteCustomer(${customer.id})" class="text-red-600 hover:text-red-900">Sil</button>
                    </td>
                </tr>
            `).join('');
        }

        // Reports
        function renderReports() {
            renderTopProducts();
            renderStockStatus();
        }

        function renderTopProducts() {
            const topProducts = products
                .filter(p => p.sold > 0)
                .sort((a, b) => b.sold - a.sold)
                .slice(0, 5);
            
            const container = document.getElementById('topProducts');
            container.innerHTML = topProducts.map((product, index) => {
                const revenue = product.sold * product.price;
                
                return `
                    <div class="flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg">
                        <div class="flex items-center">
                            <span class="w-6 h-6 bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 rounded-full flex items-center justify-center text-sm font-medium mr-3">
                                ${index + 1}
                            </span>
                            <div>
                                <div class="font-medium text-gray-900 dark:text-white">${product.name}</div>
                                <div class="text-sm text-gray-500 dark:text-gray-400">${product.category}</div>
                            </div>
                        </div>
                        <div class="text-right">
                            <div class="font-medium text-gray-900 dark:text-white">${product.sold} adet</div>
                            <div class="text-sm text-green-600">${settings.currency}${revenue.toLocaleString('tr-TR')}</div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function renderStockStatus() {
            const stockCategories = {
                critical: products.filter(p => p.stock === 0),
                low: products.filter(p => p.stock > 0 && p.stock <= (p.minStock || settings.minStock)),
                normal: products.filter(p => p.stock > (p.minStock || settings.minStock))
            };
            
            const container = document.getElementById('stockStatus');
            container.innerHTML = `
                <div class="space-y-3">
                    <div class="flex items-center justify-between p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800">
                        <div class="flex items-center">
                            <span class="text-red-600 mr-2">ğŸš¨</span>
                            <span class="font-medium text-red-800 dark:text-red-300">TÃ¼kenen ÃœrÃ¼nler</span>
                        </div>
                        <span class="font-bold text-red-600">${stockCategories.critical.length}</span>
                    </div>
                    
                    <div class="flex items-center justify-between p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800">
                        <div class="flex items-center">
                            <span class="text-yellow-600 mr-2">âš ï¸</span>
                            <span class="font-medium text-yellow-800 dark:text-yellow-300">DÃ¼ÅŸÃ¼k Stok</span>
                        </div>
                        <span class="font-bold text-yellow-600">${stockCategories.low.length}</span>
                    </div>
                    
                    <div class="flex items-center justify-between p-3 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800">
                        <div class="flex items-center">
                            <span class="text-green-600 mr-2">âœ…</span>
                            <span class="font-medium text-green-800 dark:text-green-300">Normal Stok</span>
                        </div>
                        <span class="font-bold text-green-600">${stockCategories.normal.length}</span>
                    </div>
                </div>
            `;
        }

        // Modal Functions
        function showModal(modalId) {
            document.getElementById(modalId).classList.remove('hidden');
        }

        function hideModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Serial Number Functions
        function showSerialNumbers(productId) {
            const product = products.find(p => p.id === productId);
            if (product && product.serialNumbers) {
                const container = document.getElementById('serialList');
                container.innerHTML = product.serialNumbers.map((serial, index) => `
                    <div class="flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700 rounded">
                        <span class="text-sm font-mono">${serial}</span>
                        <span class="text-xs text-gray-500">#${index + 1}</span>
                    </div>
                `).join('');
                showModal('serialModal');
            }
        }

        function updateSerialNumberSection() {
            const category = document.getElementById('productCategory').value;
            const section = document.getElementById('serialNumberSection');
            const stockInput = document.getElementById('productStock');
            
            if (category === 'Telefon') {
                section.classList.remove('hidden');
                updateSerialInputs();
            } else {
                section.classList.add('hidden');
            }
        }

        function updateSerialInputs() {
            const stock = parseInt(document.getElementById('productStock').value) || 0;
            const container = document.getElementById('serialNumbers');
            const currentInputs = container.querySelectorAll('.serial-input').length;
            
            if (stock > currentInputs) {
                // Add more inputs
                for (let i = currentInputs; i < stock; i++) {
                    const div = document.createElement('div');
                    div.className = 'flex gap-2';
                    div.innerHTML = `
                        <input type="text" class="serial-input flex-1 px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Seri numarasÄ± ${i + 1}">
                        <button type="button" class="remove-serial text-red-600 hover:text-red-800 px-3 py-2 text-sm">Ã—</button>
                    `;
                    container.appendChild(div);
                }
            } else if (stock < currentInputs) {
                // Remove excess inputs
                const inputs = container.querySelectorAll('.flex');
                for (let i = currentInputs - 1; i >= stock; i--) {
                    if (inputs[i]) inputs[i].remove();
                }
            }
        }

        function collectSerialNumbers() {
            const inputs = document.querySelectorAll('.serial-input');
            const serials = [];
            inputs.forEach(input => {
                if (input.value.trim()) {
                    serials.push(input.value.trim());
                }
            });
            return serials;
        }

        // Product Modal Functions
        function editProduct(id) {
            const product = products.find(p => p.id === id);
            if (product) {
                document.getElementById('productId').value = product.id;
                document.getElementById('productName').value = product.name;
                document.getElementById('productCategory').value = product.category;
                document.getElementById('productBrand').value = product.brand || '';
                document.getElementById('productModel').value = product.model || '';
                document.getElementById('productColor').value = product.color || '';
                document.getElementById('productStorage').value = product.storage || '';
                document.getElementById('productRam').value = product.ram || '';
                document.getElementById('productCondition').value = product.condition || '';
                document.getElementById('productWarranty').value = product.warranty || '';
                document.getElementById('productBattery').value = product.battery || '';
                document.getElementById('productScreen').value = product.screen || '';
                document.getElementById('productCase').value = product.case || '';
                document.getElementById('productBox').value = product.box || '';
                document.getElementById('productSim').value = product.sim || '';
                document.getElementById('productOS').value = product.os || '';
                document.getElementById('productFeatures').value = product.features || '';
                document.getElementById('productDescription').value = product.description || '';
                document.getElementById('productStock').value = product.stock;
                document.getElementById('productMinStock').value = product.minStock || settings.minStock;
                document.getElementById('productCostPrice').value = product.costPrice || 0;
                document.getElementById('productPrice').value = product.price;
                
                // Handle serial numbers for phones
                updateSerialNumberSection();
                if (product.category === 'Telefon' && product.serialNumbers) {
                    const inputs = document.querySelectorAll('.serial-input');
                    product.serialNumbers.forEach((serial, index) => {
                        if (inputs[index]) {
                            inputs[index].value = serial;
                        }
                    });
                }
                
                showModal('productModal');
            }
        }

        function deleteProduct(id) {
            console.log('ğŸ—‘ï¸ ÃœrÃ¼n silme iÅŸlemi baÅŸlÄ±yor, ID:', id);
            
            try {
                const product = products.find(p => p.id === id);
                if (!product) {
                    console.error('âŒ ÃœrÃ¼n bulunamadÄ±, ID:', id);
                    alert('âŒ ÃœrÃ¼n bulunamadÄ±!');
                    return;
                }
                
                console.log('ğŸ“¦ Silinecek Ã¼rÃ¼n:', product.name);
                
                // Check if product has been sold
                const soldCount = product.sold || 0;
                console.log('ğŸ“Š SatÄ±ÅŸ sayÄ±sÄ±:', soldCount);
                
                if (soldCount > 0) {
                    const confirmMessage = `âš ï¸ DÄ°KKAT!\n\n"${product.name}" Ã¼rÃ¼nÃ¼ daha Ã¶nce ${soldCount} kez satÄ±lmÄ±ÅŸ.\n\nÃœrÃ¼nÃ¼ silerseniz:\nâ€¢ SatÄ±ÅŸ geÃ§miÅŸi korunacak\nâ€¢ Raporlarda "SilinmiÅŸ ÃœrÃ¼n" olarak gÃ¶rÃ¼necek\nâ€¢ Bu iÅŸlem geri alÄ±namaz\n\nYine de silmek istediÄŸinizden emin misiniz?`;
                    
                    if (!confirm(confirmMessage)) {
                        console.log('âŒ KullanÄ±cÄ± silme iÅŸlemini iptal etti (1. onay)');
                        return;
                    }
                    
                    // Second confirmation for sold products
                    if (!confirm(`ğŸ”´ SON ONAY\n\n"${product.name}" Ã¼rÃ¼nÃ¼ kalÄ±cÄ± olarak silinecek.\n\nBu iÅŸlem GERÄ° ALINAMAZ!\n\nEmin misiniz?`)) {
                        console.log('âŒ KullanÄ±cÄ± silme iÅŸlemini iptal etti (2. onay)');
                        return;
                    }
                    
                    console.log('âœ… KullanÄ±cÄ± satÄ±lmÄ±ÅŸ Ã¼rÃ¼n silme iÅŸlemini onayladÄ±');
                } else {
                    if (!confirm(`ğŸ—‘ï¸ "${product.name}" Ã¼rÃ¼nÃ¼ silinecek.\n\nBu iÅŸlem geri alÄ±namaz.\n\nEmin misiniz?`)) {
                        console.log('âŒ KullanÄ±cÄ± silme iÅŸlemini iptal etti');
                        return;
                    }
                    
                    console.log('âœ… KullanÄ±cÄ± Ã¼rÃ¼n silme iÅŸlemini onayladÄ±');
                }
                
                // Perform deletion
                console.log('ğŸ”„ ÃœrÃ¼n siliniyor...');
                const originalLength = products.length;
                products = products.filter(p => p.id !== id);
                
                if (products.length === originalLength - 1) {
                    console.log('âœ… ÃœrÃ¼n baÅŸarÄ±yla silindi');
                    saveData();
                    renderProducts();
                    updateDashboard();
                    
                    // Show success message
                    alert(`âœ… "${product.name}" baÅŸarÄ±yla silindi!${soldCount > 0 ? '\n\nğŸ“‹ SatÄ±ÅŸ kayÄ±tlarÄ± korundu ve "SilinmiÅŸ ÃœrÃ¼n" olarak gÃ¶rÃ¼necek.' : ''}`);
                } else {
                    throw new Error('ÃœrÃ¼n silinemedi - array filtresi baÅŸarÄ±sÄ±z');
                }
                
            } catch (error) {
                console.error('âŒ ÃœrÃ¼n silme hatasÄ±:', error);
                console.error('Hata detaylarÄ±:', {
                    message: error.message,
                    stack: error.stack,
                    productId: id
                });
                
                alert(`âŒ ÃœrÃ¼n silinirken hata oluÅŸtu!\n\nHata: ${error.message}\n\nLÃ¼tfen tekrar deneyin.`);
            }
        }

        // Customer Modal Functions
        function editCustomer(id) {
            const customer = customers.find(c => c.id === id);
            if (customer) {
                document.getElementById('customerId').value = customer.id;
                document.getElementById('customerName').value = customer.name;
                document.getElementById('customerPhone').value = customer.phone;
                document.getElementById('customerEmail').value = customer.email || '';
                document.getElementById('customerAddress').value = customer.address || '';
                showModal('customerModal');
            }
        }

        function deleteCustomer(id) {
            console.log('ğŸ—‘ï¸ MÃ¼ÅŸteri silme iÅŸlemi baÅŸlÄ±yor, ID:', id);
            
            try {
                const customer = customers.find(c => c.id === id);
                if (!customer) {
                    console.error('âŒ MÃ¼ÅŸteri bulunamadÄ±, ID:', id);
                    alert('âŒ MÃ¼ÅŸteri bulunamadÄ±!');
                    return;
                }
                
                console.log('ğŸ‘¤ Silinecek mÃ¼ÅŸteri:', customer.name);
                
                // Check if customer has sales history
                const customerSales = sales.filter(s => s.customerId === id);
                const salesCount = customerSales.length;
                const totalPurchases = customer.totalPurchases || 0;
                
                console.log('ğŸ“Š MÃ¼ÅŸteri istatistikleri:', {
                    salesCount,
                    totalPurchases
                });
                
                if (salesCount > 0) {
                    const confirmMessage = `âš ï¸ DÄ°KKAT!\n\n"${customer.name}" mÃ¼ÅŸterisinin:\nâ€¢ ${salesCount} adet satÄ±ÅŸ kaydÄ± var\nâ€¢ Toplam ${totalPurchases.toLocaleString('tr-TR')} â‚º alÄ±ÅŸveriÅŸ yapmÄ±ÅŸ\n\nMÃ¼ÅŸteriyi silerseniz:\nâ€¢ SatÄ±ÅŸ kayÄ±tlarÄ± korunacak\nâ€¢ SatÄ±ÅŸlarda "SilinmiÅŸ MÃ¼ÅŸteri" olarak gÃ¶rÃ¼necek\nâ€¢ Bu iÅŸlem geri alÄ±namaz\n\nYine de silmek istediÄŸinizden emin misiniz?`;
                    
                    if (!confirm(confirmMessage)) {
                        console.log('âŒ KullanÄ±cÄ± mÃ¼ÅŸteri silme iÅŸlemini iptal etti (1. onay)');
                        return;
                    }
                    
                    // Second confirmation for customers with sales
                    if (!confirm(`ğŸ”´ SON ONAY\n\n"${customer.name}" mÃ¼ÅŸterisi kalÄ±cÄ± olarak silinecek.\n\nBu iÅŸlem GERÄ° ALINAMAZ!\n\nEmin misiniz?`)) {
                        console.log('âŒ KullanÄ±cÄ± mÃ¼ÅŸteri silme iÅŸlemini iptal etti (2. onay)');
                        return;
                    }
                    
                    console.log('âœ… KullanÄ±cÄ± satÄ±ÅŸ geÃ§miÅŸi olan mÃ¼ÅŸteri silme iÅŸlemini onayladÄ±');
                } else {
                    if (!confirm(`ğŸ—‘ï¸ "${customer.name}" mÃ¼ÅŸterisi silinecek.\n\nBu iÅŸlem geri alÄ±namaz.\n\nEmin misiniz?`)) {
                        console.log('âŒ KullanÄ±cÄ± mÃ¼ÅŸteri silme iÅŸlemini iptal etti');
                        return;
                    }
                    
                    console.log('âœ… KullanÄ±cÄ± mÃ¼ÅŸteri silme iÅŸlemini onayladÄ±');
                }
                
                // Perform deletion
                console.log('ğŸ”„ MÃ¼ÅŸteri siliniyor...');
                const originalLength = customers.length;
                customers = customers.filter(c => c.id !== id);
                
                if (customers.length === originalLength - 1) {
                    console.log('âœ… MÃ¼ÅŸteri baÅŸarÄ±yla silindi');
                    saveData();
                    renderCustomers();
                    renderSales(); // Update sales list to show "SilinmiÅŸ MÃ¼ÅŸteri"
                    
                    // Show success message
                    alert(`âœ… "${customer.name}" baÅŸarÄ±yla silindi!${salesCount > 0 ? '\n\nğŸ“‹ SatÄ±ÅŸ kayÄ±tlarÄ± korundu ve "SilinmiÅŸ MÃ¼ÅŸteri" olarak gÃ¶rÃ¼necek.' : ''}`);
                } else {
                    throw new Error('MÃ¼ÅŸteri silinemedi - array filtresi baÅŸarÄ±sÄ±z');
                }
                
            } catch (error) {
                console.error('âŒ MÃ¼ÅŸteri silme hatasÄ±:', error);
                console.error('Hata detaylarÄ±:', {
                    message: error.message,
                    stack: error.stack,
                    customerId: id
                });
                
                alert(`âŒ MÃ¼ÅŸteri silinirken hata oluÅŸtu!\n\nHata: ${error.message}\n\nLÃ¼tfen tekrar deneyin.`);
            }
        }

        // Sale Functions
        function generateInvoiceNumber() {
            const lastSale = sales.sort((a, b) => b.id - a.id)[0];
            const lastNumber = lastSale ? parseInt(lastSale.invoiceNumber.split('-')[1]) : 0;
            return `INV-${String(lastNumber + 1).padStart(3, '0')}`;
        }

        function updateSaleItemOptions() {
            const selects = document.querySelectorAll('.sale-product');
            const options = '<option value="">ÃœrÃ¼n SeÃ§in</option>' + 
                products.filter(p => p.stock > 0).map(p => 
                    `<option value="${p.id}" data-price="${p.price}">${p.name} (Stok: ${p.stock})</option>`
                ).join('');
            
            selects.forEach(select => {
                select.innerHTML = options;
            });
        }

        function updateCustomerOptions() {
            const select = document.getElementById('saleCustomer');
            select.innerHTML = '<option value="">MÃ¼ÅŸteri SeÃ§in (Zorunlu)</option>' +
                customers.map(c => `<option value="${c.id}">${c.name}</option>`).join('');
        }

        // PDF Receipt Generation
        function generatePDFReceipt(sale) {
            console.log('ğŸ–¨ï¸ PDF fiÅŸ oluÅŸturma baÅŸlÄ±yor...', sale);
            
            try {
                // Check if jsPDF is available
                if (typeof window.jspdf === 'undefined') {
                    console.error('âŒ jsPDF kÃ¼tÃ¼phanesi bulunamadÄ±');
                    alert('âŒ PDF kÃ¼tÃ¼phanesi yÃ¼klenemedi!\n\nSayfa yenilenerek tekrar deneyin.');
                    return false;
                }
                
                console.log('âœ… jsPDF kÃ¼tÃ¼phanesi hazÄ±r');
                const { jsPDF } = window.jspdf;
                
                // Create PDF document
                const doc = new jsPDF({
                    orientation: 'portrait',
                    unit: 'mm',
                    format: 'a4'
                });
                
                console.log('ğŸ“„ PDF dokÃ¼manÄ± oluÅŸturuldu');
                
                // Company info
                const company = {
                    name: settings.companyName || 'EYMEN MOBILE ELEKTRONIK',
                    phone: settings.companyPhone || '+90 555 123 45 67',
                    email: settings.companyEmail || '',
                    address: settings.companyAddress || ''
                };
                
                // Customer info
                const customer = sale.customerId ? customers.find(c => c.id === sale.customerId) : null;
                console.log('ğŸ‘¤ MÃ¼ÅŸteri bilgisi:', customer ? customer.name : 'MÃ¼ÅŸteri yok');
                
                // Set font for better Turkish character support
                doc.setFont('helvetica', 'normal');
                
                // Header - Company Name (centered)
                doc.setFontSize(18);
                doc.setTextColor(0, 0, 0);
                const companyNameWidth = doc.getTextWidth(company.name);
                doc.text(company.name, (210 - companyNameWidth) / 2, 20);
                
                // Company contact info (left side)
                doc.setFontSize(9);
                let contactY = 30;
                doc.text(company.phone, 20, contactY);
                
                if (company.email) {
                    contactY += 6;
                    doc.text(company.email, 20, contactY);
                }
                
                if (company.address) {
                    contactY += 6;
                    const addressLines = doc.splitTextToSize(company.address, 80);
                    addressLines.forEach(line => {
                        doc.text(line, 20, contactY);
                        contactY += 6;
                    });
                }
                
                // Invoice info (right side)
                doc.setFontSize(14);
                doc.setFont('helvetica', 'bold');
                doc.text('SATIS FISI', 150, 20);
                
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(10);
                doc.text(`Fis No: ${sale.invoiceNumber}`, 150, 30);
                doc.text(`Tarih: ${new Date(sale.date).toLocaleDateString('tr-TR')}`, 150, 36);
                doc.text(`Saat: ${sale.time}`, 150, 42);
                
                // Separator line
                doc.setLineWidth(0.5);
                doc.line(20, 55, 190, 55);
                
                // Customer section
                let currentY = 65;
                doc.setFontSize(11);
                doc.setFont('helvetica', 'bold');
                doc.text('MUSTERI BILGILERI:', 20, currentY);
                
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(9);
                currentY += 8;
                
                if (customer) {
                    doc.text(`Ad Soyad: ${customer.name}`, 20, currentY);
                    currentY += 6;
                    doc.text(`Telefon: ${customer.phone}`, 20, currentY);
                    currentY += 6;
                    
                    if (customer.email) {
                        doc.text(`E-posta: ${customer.email}`, 20, currentY);
                        currentY += 6;
                    }
                    
                    if (customer.address) {
                        const addressLines = doc.splitTextToSize(`Adres: ${customer.address}`, 160);
                        addressLines.forEach(line => {
                            doc.text(line, 20, currentY);
                            currentY += 6;
                        });
                    }
                } else {
                    doc.text('Musteri bilgisi mevcut degil', 20, currentY);
                    currentY += 6;
                }
                
                // Separator line
                currentY += 5;
                doc.line(20, currentY, 190, currentY);
                currentY += 10;
                
                // Products table header
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(9);
                doc.text('URUN', 20, currentY);
                doc.text('ADET', 110, currentY);
                doc.text('FIYAT', 130, currentY);
                doc.text('TOPLAM', 160, currentY);
                
                currentY += 3;
                doc.line(20, currentY, 190, currentY);
                currentY += 8;
                
                // Products
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(8);
                
                console.log('ğŸ“¦ ÃœrÃ¼nler iÅŸleniyor...', sale.items.length, 'adet');
                
                sale.items.forEach((item, index) => {
                    const product = products.find(p => p.id === item.productId);
                    const productName = product ? product.name : `Silinmis Urun (ID: ${item.productId})`;
                    const itemTotal = item.quantity * item.price;
                    
                    console.log(`  - ${productName}: ${item.quantity} x ${item.price} = ${itemTotal}`);
                    
                    // Check if we need a new page
                    if (currentY > 250) {
                        console.log('ğŸ“„ Yeni sayfa ekleniyor...');
                        doc.addPage();
                        currentY = 20;
                    }
                    
                    // Product name with text wrapping
                    const maxProductNameWidth = 85;
                    const productLines = doc.splitTextToSize(productName, maxProductNameWidth);
                    
                    // Draw product info
                    productLines.forEach((line, lineIndex) => {
                        doc.text(line, 20, currentY + (lineIndex * 5));
                    });
                    
                    // Quantity, price, total (aligned to the first line)
                    doc.text(item.quantity.toString(), 110, currentY);
                    doc.text(`${settings.currency}${item.price.toLocaleString('tr-TR')}`, 130, currentY);
                    doc.text(`${settings.currency}${itemTotal.toLocaleString('tr-TR')}`, 160, currentY);
                    
                    currentY += Math.max(productLines.length * 5, 8) + 3;
                });
                
                // Total section
                currentY += 5;
                doc.setLineWidth(0.8);
                doc.line(20, currentY, 190, currentY);
                currentY += 10;
                
                doc.setFont('helvetica', 'bold');
                doc.setFontSize(12);
                doc.text('GENEL TOPLAM:', 110, currentY);
                doc.setFontSize(14);
                doc.text(`${settings.currency}${sale.total.toLocaleString('tr-TR')}`, 160, currentY);
                
                // Footer
                currentY += 20;
                doc.setFont('helvetica', 'normal');
                doc.setFontSize(7);
                doc.text('Bu fis elektronik ortamda olusturulmustur.', 20, currentY);
                doc.text(`Olusturma Tarihi: ${new Date().toLocaleString('tr-TR')}`, 20, currentY + 5);
                
                // Generate filename with proper date format
                const dateStr = sale.date.replace(/-/g, '');
                const fileName = `Fis_${sale.invoiceNumber}_${dateStr}.pdf`;
                console.log('ğŸ’¾ PDF dosya adÄ±:', fileName);
                
                // Save PDF
                doc.save(fileName);
                console.log('âœ… PDF baÅŸarÄ±yla oluÅŸturuldu ve indirildi!');
                
                return true;
                
            } catch (error) {
                console.error('âŒ PDF oluÅŸturma hatasÄ±:', error);
                console.error('Hata detaylarÄ±:', {
                    message: error.message,
                    stack: error.stack,
                    sale: sale
                });
                
                alert(`âŒ PDF oluÅŸturulurken hata oluÅŸtu!\n\nHata: ${error.message}\n\nLÃ¼tfen:\n1. SayfayÄ± yenileyin\n2. Tekrar deneyin\n3. Sorun devam ederse tarayÄ±cÄ±nÄ±zÄ± gÃ¼ncelleyin`);
                return false;
            }
        }

        function calculateSaleTotal() {
            let total = 0;
            document.querySelectorAll('.sale-item').forEach(item => {
                const quantity = parseInt(item.querySelector('.sale-quantity').value) || 0;
                const price = parseFloat(item.querySelector('.sale-price').value) || 0;
                const itemTotal = quantity * price;
                item.querySelector('.sale-total').textContent = `${settings.currency}${itemTotal.toLocaleString('tr-TR')}`;
                total += itemTotal;
            });
            document.getElementById('grandTotal').textContent = `${settings.currency}${total.toLocaleString('tr-TR')}`;
        }

        // Data Management Functions
        function exportData() {
            const data = {
                products,
                customers,
                sales,
                settings,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `stokpro-backup-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('Veriler baÅŸarÄ±yla dÄ±ÅŸa aktarÄ±ldÄ±!');
        }

        function importData() {
            document.getElementById('importFile').click();
        }

        function resetData() {
            if (confirm('TÃœM VERÄ°LER SÄ°LÄ°NECEK! Bu iÅŸlem geri alÄ±namaz. Devam etmek istediÄŸinizden emin misiniz?')) {
                if (confirm('Son uyarÄ±: TÃ¼m Ã¼rÃ¼nler, mÃ¼ÅŸteriler, satÄ±ÅŸlar ve ayarlar silinecek. Emin misiniz?')) {
                    localStorage.clear();
                    location.reload();
                }
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            updateDashboard();
            updateCompanyDisplay();

            // Company info click to edit
            document.getElementById('companyInfo').addEventListener('click', () => {
                document.querySelector('[data-tab="settings"]').click();
            });

            // Search and filter event listeners
            document.getElementById('searchProduct').addEventListener('input', renderProducts);
            document.getElementById('categoryFilter').addEventListener('change', renderProducts);
            document.getElementById('brandFilter').addEventListener('change', renderProducts);
            document.getElementById('conditionFilter').addEventListener('change', renderProducts);
            document.getElementById('stockFilter').addEventListener('change', renderProducts);
            document.getElementById('colorFilter').addEventListener('change', renderProducts);
            document.getElementById('searchCustomer').addEventListener('input', renderCustomers);
            document.getElementById('salesDateFrom').addEventListener('change', renderSales);
            document.getElementById('salesDateTo').addEventListener('change', renderSales);
            document.getElementById('salesCustomerSearch').addEventListener('input', renderSales);
            document.getElementById('salesInvoiceSearch').addEventListener('input', renderSales);

            // Clear filters button
            document.getElementById('clearFilters').addEventListener('click', function() {
                document.getElementById('searchProduct').value = '';
                document.getElementById('categoryFilter').value = '';
                document.getElementById('brandFilter').value = '';
                document.getElementById('conditionFilter').value = '';
                document.getElementById('stockFilter').value = '';
                document.getElementById('colorFilter').value = '';
                renderProducts();
            });

            // Clear sales filters button
            document.getElementById('clearSalesFilters').addEventListener('click', function() {
                document.getElementById('salesDateFrom').value = '';
                document.getElementById('salesDateTo').value = '';
                document.getElementById('salesCustomerSearch').value = '';
                document.getElementById('salesInvoiceSearch').value = '';
                renderSales();
            });

            // Quick action buttons
            document.getElementById('quickSaleBtn').addEventListener('click', () => {
                updateCustomerOptions();
                updateSaleItemOptions();
                document.getElementById('invoiceNumber').value = generateInvoiceNumber();
                showModal('saleModal');
            });

            document.getElementById('quickAddProductBtn').addEventListener('click', () => {
                document.getElementById('productForm').reset();
                document.getElementById('productId').value = '';
                showModal('productModal');
            });

            document.getElementById('quickAddCustomerBtn').addEventListener('click', () => {
                document.getElementById('customerForm').reset();
                document.getElementById('customerId').value = '';
                showModal('customerModal');
            });

            // Main action buttons
            document.getElementById('addProductBtn').addEventListener('click', () => {
                document.getElementById('productForm').reset();
                document.getElementById('productId').value = '';
                showModal('productModal');
            });

            document.getElementById('newSaleBtn').addEventListener('click', () => {
                updateCustomerOptions();
                updateSaleItemOptions();
                document.getElementById('invoiceNumber').value = generateInvoiceNumber();
                showModal('saleModal');
            });

            document.getElementById('addCustomerBtn').addEventListener('click', () => {
                document.getElementById('customerForm').reset();
                document.getElementById('customerId').value = '';
                showModal('customerModal');
            });

            // Modal close buttons
            document.getElementById('cancelProduct').addEventListener('click', () => hideModal('productModal'));
            document.getElementById('cancelSale').addEventListener('click', () => hideModal('saleModal'));
            document.getElementById('cancelCustomer').addEventListener('click', () => hideModal('customerModal'));
            document.getElementById('closeSerialModal').addEventListener('click', () => hideModal('serialModal'));
            document.getElementById('closeSaleDetail').addEventListener('click', () => hideModal('saleDetailModal'));
            document.getElementById('closeSaleDetailBtn').addEventListener('click', () => hideModal('saleDetailModal'));

            // Settings event listeners
            document.getElementById('companyForm').addEventListener('submit', function(e) {
                e.preventDefault();
                settings.companyName = document.getElementById('settingsCompanyName').value;
                settings.companyPhone = document.getElementById('settingsCompanyPhone').value;
                settings.companyEmail = document.getElementById('settingsCompanyEmail').value;
                settings.companyAddress = document.getElementById('settingsCompanyAddress').value;
                saveData();
                updateCompanyDisplay();
                alert('Firma bilgileri baÅŸarÄ±yla kaydedildi!');
            });

            document.getElementById('settingsThemeToggle').addEventListener('click', function() {
                document.documentElement.classList.toggle('dark');
                const isDarkMode = document.documentElement.classList.contains('dark');
                const slider = document.getElementById('settingsThemeSlider');
                const toggle = this;
                
                if (isDarkMode) {
                    slider.classList.add('translate-x-6');
                    toggle.classList.add('bg-blue-600');
                    toggle.classList.remove('bg-gray-200');
                    document.getElementById('themeIcon').textContent = 'â˜€ï¸';
                } else {
                    slider.classList.remove('translate-x-6');
                    toggle.classList.remove('bg-blue-600');
                    toggle.classList.add('bg-gray-200');
                    document.getElementById('themeIcon').textContent = 'ğŸŒ™';
                }
                
                localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
                settings.theme = isDarkMode ? 'dark' : 'light';
                saveData();
            });

            document.getElementById('saveSystemSettings').addEventListener('click', function() {
                settings.minStock = parseInt(document.getElementById('settingsMinStock').value);
                settings.currency = document.getElementById('settingsCurrency').value;
                saveData();
                alert('Sistem ayarlarÄ± baÅŸarÄ±yla kaydedildi!');
                updateDashboard();
            });

            // Data management buttons
            document.getElementById('exportData').addEventListener('click', exportData);
            document.getElementById('importData').addEventListener('click', importData);
            document.getElementById('resetData').addEventListener('click', resetData);
            document.getElementById('exportSalesReport').addEventListener('click', exportSalesReport);

            document.getElementById('importFile').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        try {
                            const data = JSON.parse(e.target.result);
                            if (data.products && data.customers && data.sales) {
                                if (confirm('Mevcut veriler silinecek ve yeni veriler yÃ¼klenecek. Devam etmek istediÄŸiniz emin misiniz?')) {
                                    products = data.products;
                                    customers = data.customers;
                                    sales = data.sales;
                                    if (data.settings) settings = data.settings;
                                    saveData();
                                    location.reload();
                                }
                            } else {
                                alert('GeÃ§ersiz dosya formatÄ±!');
                            }
                        } catch (error) {
                            alert('Dosya okuma hatasÄ±!');
                        }
                    };
                    reader.readAsText(file);
                }
            });

            // Category change listener for serial numbers
            document.getElementById('productCategory').addEventListener('change', updateSerialNumberSection);
            document.getElementById('productStock').addEventListener('input', function() {
                if (document.getElementById('productCategory').value === 'Telefon') {
                    updateSerialInputs();
                }
            });

            // Form submissions
            document.getElementById('productForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const id = document.getElementById('productId').value;
                const productData = {
                    name: document.getElementById('productName').value,
                    category: document.getElementById('productCategory').value,
                    brand: document.getElementById('productBrand').value,
                    model: document.getElementById('productModel').value,
                    color: document.getElementById('productColor').value,
                    storage: document.getElementById('productStorage').value,
                    ram: document.getElementById('productRam').value,
                    condition: document.getElementById('productCondition').value,
                    warranty: document.getElementById('productWarranty').value,
                    battery: document.getElementById('productBattery').value,
                    screen: document.getElementById('productScreen').value,
                    case: document.getElementById('productCase').value,
                    box: document.getElementById('productBox').value,
                    sim: document.getElementById('productSim').value,
                    os: document.getElementById('productOS').value,
                    features: document.getElementById('productFeatures').value,
                    description: document.getElementById('productDescription').value,
                    stock: parseInt(document.getElementById('productStock').value),
                    minStock: parseInt(document.getElementById('productMinStock').value),
                    costPrice: parseFloat(document.getElementById('productCostPrice').value),
                    price: parseFloat(document.getElementById('productPrice').value),
                    sold: 0
                };

                // Add serial numbers for phones
                if (productData.category === 'Telefon') {
                    productData.serialNumbers = collectSerialNumbers();
                    
                    // Validate serial numbers for phones
                    if (productData.serialNumbers.length !== productData.stock) {
                        alert(`Telefon kategorisi iÃ§in ${productData.stock} adet seri numarasÄ± girmelisiniz.`);
                        return;
                    }
                    
                    // Check for duplicate serial numbers
                    const duplicates = productData.serialNumbers.filter((serial, index) => 
                        productData.serialNumbers.indexOf(serial) !== index
                    );
                    if (duplicates.length > 0) {
                        alert('Seri numaralarÄ± tekrar edemez!');
                        return;
                    }
                }

                if (id) {
                    const index = products.findIndex(p => p.id === parseInt(id));
                    products[index] = { ...products[index], ...productData };
                } else {
                    const newId = Math.max(...products.map(p => p.id), 0) + 1;
                    products.push({ id: newId, ...productData });
                }

                saveData();
                hideModal('productModal');
                renderProducts();
                updateDashboard();
            });

            document.getElementById('customerForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const id = document.getElementById('customerId').value;
                const customerData = {
                    name: document.getElementById('customerName').value,
                    phone: document.getElementById('customerPhone').value,
                    email: document.getElementById('customerEmail').value,
                    address: document.getElementById('customerAddress').value,
                    totalPurchases: 0
                };

                if (id) {
                    const index = customers.findIndex(c => c.id === parseInt(id));
                    customers[index] = { ...customers[index], ...customerData };
                } else {
                    const newId = Math.max(...customers.map(c => c.id), 0) + 1;
                    customers.push({ id: newId, ...customerData });
                }

                saveData();
                hideModal('customerModal');
                renderCustomers();
            });

            // New customer button in sale modal
            document.getElementById('addNewCustomerBtn').addEventListener('click', () => {
                document.getElementById('customerForm').reset();
                document.getElementById('customerId').value = '';
                showModal('customerModal');
            });

            document.getElementById('saleForm').addEventListener('submit', function(e) {
                e.preventDefault();
                const customerId = document.getElementById('saleCustomer').value ? parseInt(document.getElementById('saleCustomer').value) : null;
                const invoiceNumber = document.getElementById('invoiceNumber').value;
                
                // Validate customer selection
                if (!customerId) {
                    alert('LÃ¼tfen bir mÃ¼ÅŸteri seÃ§in. SatÄ±ÅŸ iÅŸlemi iÃ§in mÃ¼ÅŸteri bilgisi zorunludur.');
                    return;
                }
                
                const items = [];
                let total = 0;
                
                document.querySelectorAll('.sale-item').forEach(item => {
                    const productId = parseInt(item.querySelector('.sale-product').value);
                    const quantity = parseInt(item.querySelector('.sale-quantity').value);
                    const price = parseFloat(item.querySelector('.sale-price').value);
                    
                    if (productId && quantity > 0 && price > 0) {
                        items.push({ productId, quantity, price });
                        total += quantity * price;
                        
                        // Update product stock and sold count
                        const product = products.find(p => p.id === productId);
                        if (product) {
                            product.stock -= quantity;
                            product.sold = (product.sold || 0) + quantity;
                        }
                    }
                });

                if (items.length > 0) {
                    const newId = Math.max(...sales.map(s => s.id), 0) + 1;
                    const now = new Date();
                    const sale = {
                        id: newId,
                        invoiceNumber,
                        items,
                        customerId,
                        total,
                        date: now.toISOString().split('T')[0],
                        time: now.toTimeString().slice(0, 5)
                    };
                    
                    sales.push(sale);
                    
                    // Update customer total purchases
                    const customer = customers.find(c => c.id === customerId);
                    if (customer) {
                        customer.totalPurchases += total;
                    }
                    
                    saveData();
                    hideModal('saleModal');
                    renderSales();
                    updateDashboard();
                    
                    // Generate PDF receipt automatically
                    console.log('ğŸ–¨ï¸ SatÄ±ÅŸ tamamlandÄ±, PDF fiÅŸ oluÅŸturuluyor...');
                    const pdfSuccess = generatePDFReceipt(sale);
                    
                    if (pdfSuccess) {
                        alert('âœ… SatÄ±ÅŸ baÅŸarÄ±yla tamamlandÄ±!\n\nğŸ“„ PDF fiÅŸ indirildi.');
                    } else {
                        alert('âœ… SatÄ±ÅŸ baÅŸarÄ±yla tamamlandÄ±!\n\nâš ï¸ PDF fiÅŸ oluÅŸturulamadÄ±, ancak satÄ±ÅŸ kaydedildi.\nFiÅŸi daha sonra "SatÄ±ÅŸlar" sekmesinden yazdÄ±rabilirsiniz.');
                    }
                } else {
                    alert('LÃ¼tfen en az bir Ã¼rÃ¼n ekleyin.');
                }
            });

            // Sale item management
            document.getElementById('addSaleItem').addEventListener('click', function() {
                const container = document.getElementById('saleItems');
                const newItem = container.children[0].cloneNode(true);
                newItem.querySelectorAll('input, select').forEach(input => {
                    input.value = input.type === 'number' ? (input.classList.contains('sale-quantity') ? '1' : '') : '';
                });
                newItem.querySelector('.sale-total').textContent = `${settings.currency}0`;
                container.appendChild(newItem);
                updateSaleItemOptions();
            });

            // Event delegation for dynamic elements
            document.addEventListener('change', function(e) {
                if (e.target.classList.contains('sale-product')) {
                    const option = e.target.selectedOptions[0];
                    if (option && option.dataset.price) {
                        e.target.closest('.sale-item').querySelector('.sale-price').value = option.dataset.price;
                        calculateSaleTotal();
                    }
                }
                
                if (e.target.classList.contains('sale-quantity') || e.target.classList.contains('sale-price')) {
                    calculateSaleTotal();
                }
            });

            document.addEventListener('click', function(e) {
                if (e.target.classList.contains('remove-item')) {
                    if (document.querySelectorAll('.sale-item').length > 1) {
                        e.target.closest('.sale-item').remove();
                        calculateSaleTotal();
                    }
                }
                
                // Serial number management
                if (e.target.classList.contains('add-serial')) {
                    const container = document.getElementById('serialNumbers');
                    const currentCount = container.querySelectorAll('.serial-input').length;
                    const div = document.createElement('div');
                    div.className = 'flex gap-2';
                    div.innerHTML = `
                        <input type="text" class="serial-input flex-1 px-3 py-2 border dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white" placeholder="Seri numarasÄ± ${currentCount + 1}">
                        <button type="button" class="remove-serial text-red-600 hover:text-red-800 px-3 py-2 text-sm">Ã—</button>
                    `;
                    container.appendChild(div);
                }
                
                if (e.target.classList.contains('remove-serial')) {
                    if (document.querySelectorAll('.serial-input').length > 1) {
                        e.target.closest('.flex').remove();
                    }
                }
            });
        });

        // Utility functions
        function viewSaleDetails(id) {
            const sale = sales.find(s => s.id === id);
            if (!sale) return;
            
            const customer = sale.customerId ? customers.find(c => c.id === sale.customerId) : null;
            
            // Fill sale info
            document.getElementById('detailInvoiceNumber').textContent = sale.invoiceNumber;
            document.getElementById('detailDate').textContent = new Date(sale.date).toLocaleDateString('tr-TR');
            document.getElementById('detailTime').textContent = sale.time;
            
            // Fill customer info
            document.getElementById('detailCustomerName').textContent = customer ? customer.name : (sale.customerId ? 'SilinmiÅŸ MÃ¼ÅŸteri' : 'MÃ¼ÅŸteri SeÃ§ilmedi');
            document.getElementById('detailCustomerPhone').textContent = customer ? customer.phone : '-';
            document.getElementById('detailCustomerEmail').textContent = customer && customer.email ? customer.email : '-';
            
            // Fill products table
            const tbody = document.getElementById('detailProductsTable');
            let totalProfit = 0;
            
            tbody.innerHTML = sale.items.map(item => {
                const product = products.find(p => p.id === item.productId);
                const productName = product ? product.name : 'SilinmiÅŸ ÃœrÃ¼n';
                const itemTotal = item.quantity * item.price;
                const itemProfit = product ? (item.price - (product.costPrice || 0)) * item.quantity : item.price * item.quantity;
                totalProfit += itemProfit;
                
                return `
                    <tr>
                        <td class="px-4 py-3 text-sm text-gray-900 dark:text-white">
                            <div class="font-medium">${productName}</div>
                            ${product && product.brand ? `<div class="text-xs text-gray-500 dark:text-gray-400">${product.brand} ${product.model || ''}</div>` : ''}
                            ${!product ? `<div class="text-xs text-red-500 dark:text-red-400">ÃœrÃ¼n silinmiÅŸ (ID: ${item.productId})</div>` : ''}
                        </td>
                        <td class="px-4 py-3 text-sm text-gray-900 dark:text-white text-center">
                            <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">
                                ${item.quantity}
                            </span>
                        </td>
                        <td class="px-4 py-3 text-sm text-gray-900 dark:text-white">
                            ${settings.currency}${item.price.toLocaleString('tr-TR')}
                        </td>
                        <td class="px-4 py-3 text-sm font-medium text-green-600">
                            ${settings.currency}${itemTotal.toLocaleString('tr-TR')}
                        </td>
                        <td class="px-4 py-3 text-sm font-medium text-orange-600">
                            ${settings.currency}${itemProfit.toLocaleString('tr-TR')}
                            ${!product ? `<div class="text-xs text-gray-500">*Tahmini</div>` : ''}
                        </td>
                    </tr>
                `;
            }).join('');
            
            // Fill summary
            document.getElementById('detailTotalAmount').textContent = `${settings.currency}${sale.total.toLocaleString('tr-TR')}`;
            document.getElementById('detailTotalProfit').textContent = `${settings.currency}${totalProfit.toLocaleString('tr-TR')}`;
            const profitMargin = sale.total > 0 ? ((totalProfit / sale.total) * 100).toFixed(1) : '0';
            document.getElementById('detailProfitMargin').textContent = `%${profitMargin}`;
            
            // Set up print button
            document.getElementById('printDetailReceipt').onclick = () => printReceipt(id);
            
            showModal('saleDetailModal');
        }

        function printReceipt(id) {
            console.log('ğŸ–¨ï¸ FiÅŸ yazdÄ±rma iÅŸlemi baÅŸlÄ±yor, SatÄ±ÅŸ ID:', id);
            
            try {
                const sale = sales.find(s => s.id === id);
                if (!sale) {
                    console.error('âŒ SatÄ±ÅŸ bulunamadÄ±, ID:', id);
                    alert('âŒ SatÄ±ÅŸ kaydÄ± bulunamadÄ±!');
                    return;
                }
                
                console.log('ğŸ“‹ YazdÄ±rÄ±lacak satÄ±ÅŸ:', sale.invoiceNumber);
                
                const success = generatePDFReceipt(sale);
                if (success) {
                    console.log('âœ… FiÅŸ baÅŸarÄ±yla yazdÄ±rÄ±ldÄ±');
                } else {
                    console.log('âŒ FiÅŸ yazdÄ±rÄ±lamadÄ±');
                }
                
            } catch (error) {
                console.error('âŒ FiÅŸ yazdÄ±rma hatasÄ±:', error);
                alert(`âŒ FiÅŸ yazdÄ±rÄ±lÄ±rken hata oluÅŸtu!\n\nHata: ${error.message}\n\nLÃ¼tfen tekrar deneyin.`);
            }
        }

        // Export Sales Report Function
        function exportSalesReport() {
            try {
                const dateFrom = document.getElementById('salesDateFrom').value;
                const dateTo = document.getElementById('salesDateTo').value;
                const customerSearch = document.getElementById('salesCustomerSearch').value.toLowerCase();
                const invoiceSearch = document.getElementById('salesInvoiceSearch').value.toLowerCase();
                
                let filteredSales = sales.filter(sale => {
                    let matchesDate = true;
                    if (dateFrom && sale.date < dateFrom) matchesDate = false;
                    if (dateTo && sale.date > dateTo) matchesDate = false;
                    
                    let matchesCustomer = true;
                    if (customerSearch) {
                        const customer = sale.customerId ? customers.find(c => c.id === sale.customerId) : null;
                        const customerName = customer ? customer.name.toLowerCase() : '';
                        matchesCustomer = customerName.includes(customerSearch);
                    }
                    
                    let matchesInvoice = true;
                    if (invoiceSearch) {
                        matchesInvoice = sale.invoiceNumber.toLowerCase().includes(invoiceSearch);
                    }
                    
                    return matchesDate && matchesCustomer && matchesInvoice;
                });
                
                // Create CSV content
                let csvContent = 'Tarih,Saat,Fatura No,MÃ¼ÅŸteri,ÃœrÃ¼nler,Toplam Tutar,Kar,Kar MarjÄ±\n';
                
                filteredSales.forEach(sale => {
                    const customer = sale.customerId ? customers.find(c => c.id === sale.customerId) : null;
                    const customerName = customer ? customer.name : (sale.customerId ? 'SilinmiÅŸ MÃ¼ÅŸteri' : 'MÃ¼ÅŸteri SeÃ§ilmedi');
                    const productNames = sale.items.map(item => {
                        const product = products.find(p => p.id === item.productId);
                        return product ? `${product.name} (${item.quantity})` : `SilinmiÅŸ ÃœrÃ¼n (${item.quantity})`;
                    }).join('; ');
                    
                    const saleProfit = sale.items.reduce((profit, item) => {
                        const product = products.find(p => p.id === item.productId);
                        if (product) {
                            return profit + ((item.price - (product.costPrice || 0)) * item.quantity);
                        }
                        // For deleted products, assume 0 cost (full price as profit)
                        return profit + (item.price * item.quantity);
                    }, 0);
                    
                    const profitMargin = sale.total > 0 ? ((saleProfit / sale.total) * 100).toFixed(1) : '0';
                    
                    csvContent += `${sale.date},${sale.time},${sale.invoiceNumber},"${customerName}","${productNames}",${sale.total},${saleProfit},${profitMargin}%\n`;
                });
                
                // Create and download file
                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', `satislar-raporu-${new Date().toISOString().split('T')[0]}.csv`);
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                alert(`${filteredSales.length} satÄ±ÅŸ kaydÄ± CSV formatÄ±nda indirildi!`);
            } catch (error) {
                console.error('Rapor dÄ±ÅŸa aktarma hatasÄ±:', error);
                alert('Rapor dÄ±ÅŸa aktarÄ±lÄ±rken bir hata oluÅŸtu.');
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'974191273673695c',t:'MTc1NjAyNTA1OC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
